<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!--
 * Copyright (c) 2009-2014 NVIDIA CORPORATION.  All rights reserved.
 *
 * NVIDIA Corporation and its licensors retain all intellectual property
 * and proprietary rights in and to this software, related documentation
 * and any modifications thereto.  Any use, reproduction, disclosure or
 * distribution of this software and related documentation without an express
 * license agreement from NVIDIA Corporation is strictly prohibited.
-->
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<title>DriveWorks SDK Reference: Single Camera Feature Tracking</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="Nvidia.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="reverb-search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="nv.css" rel="stylesheet" type="text/css" />
<link href="nvdwx.css" rel="stylesheet" type="text/css"/>
<style>
 body {
 background-position: 350px 150px;
 background-image: url(watermark.png);
 background-repeat: no-repeat;
 background-attachment: fixed;
 }
 </style>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table width="99%" border="0" cellspacing="1" cellpadding="1">
  <tbody>
    <tr valign="middle">
      <td rowspan="2" height="44" width="19%">
        <div>
            <a id="nv-logo" href="https://www.nvidia.com/"></a>
        </div>
      <td width="81%" height="44">
        <div style="text-align:right; font-weight: bold; font-size:20px"> <br/>DriveWorks SDK Reference </div>
        <div style="text-align:right">
        5.10.87 Release <br/> For Test and Development only <br/> <br/> </div>
    </td>
  </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('imageprocessing_tracking_featuretracker_usecase1.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Single Camera Feature Tracking </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >This tutorial shows how dwFeature2DDetector and dwFeature2DTracker modules are typically used. Note that error handling is left out for clarity.</p>
<h3>Initialize feature history array on both CPU and GPU</h3>
<div class="fragment"><div class="line"><a class="code hl_function" href="group__featureArray__group.html#gae638b572d3bef4c29ebe29531b58354c">dwFeatureHistoryArray_create</a>(&amp;featureHistoryCPU, maxFeatureCount, maxHistoryCapacity,</div>
<div class="line">                             <a class="code hl_enumvalue" href="group__core__types__group.html#gga71b04af11695393d59ac9aca72f93023a9729e85945ecb1a598a445897aeb545c">DW_MEMORY_TYPE_CPU</a>, contextHandle);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="group__featureArray__group.html#gae638b572d3bef4c29ebe29531b58354c">dwFeatureHistoryArray_create</a>(&amp;featureHistoryGPU, maxFeatureCount, maxHistoryCapacity,</div>
<div class="line">                             <a class="code hl_enumvalue" href="group__core__types__group.html#gga71b04af11695393d59ac9aca72f93023ac9656206fa925a04a1a14bdfa5ab6a40">DW_MEMORY_TYPE_CUDA</a>, contextHandle);</div>
<div class="ttc" id="agroup__core__types__group_html_gga71b04af11695393d59ac9aca72f93023a9729e85945ecb1a598a445897aeb545c"><div class="ttname"><a href="group__core__types__group.html#gga71b04af11695393d59ac9aca72f93023a9729e85945ecb1a598a445897aeb545c">DW_MEMORY_TYPE_CPU</a></div><div class="ttdeci">@ DW_MEMORY_TYPE_CPU</div><div class="ttdoc">pageable CPU memory</div><div class="ttdef"><b>Definition:</b> <a href="Types_8h_source.html#l00181">Types.h:181</a></div></div>
<div class="ttc" id="agroup__core__types__group_html_gga71b04af11695393d59ac9aca72f93023ac9656206fa925a04a1a14bdfa5ab6a40"><div class="ttname"><a href="group__core__types__group.html#gga71b04af11695393d59ac9aca72f93023ac9656206fa925a04a1a14bdfa5ab6a40">DW_MEMORY_TYPE_CUDA</a></div><div class="ttdeci">@ DW_MEMORY_TYPE_CUDA</div><div class="ttdoc">CUDA memory.</div><div class="ttdef"><b>Definition:</b> <a href="Types_8h_source.html#l00178">Types.h:178</a></div></div>
<div class="ttc" id="agroup__featureArray__group_html_gae638b572d3bef4c29ebe29531b58354c"><div class="ttname"><a href="group__featureArray__group.html#gae638b572d3bef4c29ebe29531b58354c">dwFeatureHistoryArray_create</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwFeatureHistoryArray_create(dwFeatureHistoryArray *featureHistoryArray, const uint32_t maxFeatureCount, const uint32_t maxHistoryCapacity, const dwMemoryType memoryType, dwContextHandle_t context)</div><div class="ttdoc">Creates and initializes a feature history array.</div></div>
</div><!-- fragment --><h3>Initialize feature array on GPU for detector</h3>
<div class="fragment"><div class="line"><a class="code hl_function" href="group__featureArray__group.html#gacea0d10ba2271450e4ad00061f3589ac">dwFeatureArray_create</a>(&amp;featuresDetected, maxFeatureCount, <a class="code hl_enumvalue" href="group__core__types__group.html#gga71b04af11695393d59ac9aca72f93023ac9656206fa925a04a1a14bdfa5ab6a40">DW_MEMORY_TYPE_CUDA</a>, contextHandle);</div>
<div class="ttc" id="agroup__featureArray__group_html_gacea0d10ba2271450e4ad00061f3589ac"><div class="ttname"><a href="group__featureArray__group.html#gacea0d10ba2271450e4ad00061f3589ac">dwFeatureArray_create</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwFeatureArray_create(dwFeatureArray *featureArray, const uint32_t maxFeatureCount, const dwMemoryType memoryType, dwContextHandle_t context)</div><div class="ttdoc">Creates and initializes a feature array.</div></div>
</div><!-- fragment --><h3>Initialize feature detector and tracker parameters with default values</h3>
<div class="fragment"><div class="line"><a class="code hl_struct" href="group__featureDetector__group.html#structdwFeature2DDetectorConfig">dwFeature2DDetectorConfig</a> detectorConfig = {};</div>
<div class="line"><a class="code hl_function" href="group__featureDetector__group.html#gac222b04a04af254513aaf9406c47498c">dwFeature2DDetector_initDefaultParams</a>(&amp;detectorConfig);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_struct" href="group__feature2dtracker__group.html#structdwFeature2DTrackerConfig">dwFeature2DTrackerConfig</a> trackerConfig = {};</div>
<div class="line"><a class="code hl_function" href="group__feature2dtracker__group.html#gacc7433d0e649cb138c356f9ce005fccc">dwFeature2DTracker_initDefaultParams</a>(&amp;trackerConfig);</div>
<div class="ttc" id="agroup__feature2dtracker__group_html_gacc7433d0e649cb138c356f9ce005fccc"><div class="ttname"><a href="group__feature2dtracker__group.html#gacc7433d0e649cb138c356f9ce005fccc">dwFeature2DTracker_initDefaultParams</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwFeature2DTracker_initDefaultParams(dwFeature2DTrackerConfig *params)</div><div class="ttdoc">Initializes dwFeature2DTracker parameters with default values.</div></div>
<div class="ttc" id="agroup__feature2dtracker__group_html_structdwFeature2DTrackerConfig"><div class="ttname"><a href="group__feature2dtracker__group.html#structdwFeature2DTrackerConfig">dwFeature2DTrackerConfig</a></div><div class="ttdoc">Holds configuration parameters for a feature tracker.</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTracker_8h_source.html#l00091">FeatureTracker.h:92</a></div></div>
<div class="ttc" id="agroup__featureDetector__group_html_gac222b04a04af254513aaf9406c47498c"><div class="ttname"><a href="group__featureDetector__group.html#gac222b04a04af254513aaf9406c47498c">dwFeature2DDetector_initDefaultParams</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwFeature2DDetector_initDefaultParams(dwFeature2DDetectorConfig *params)</div><div class="ttdoc">Initializes dwFeature2DDetector parameters with default values.</div></div>
<div class="ttc" id="agroup__featureDetector__group_html_structdwFeature2DDetectorConfig"><div class="ttname"><a href="group__featureDetector__group.html#structdwFeature2DDetectorConfig">dwFeature2DDetectorConfig</a></div><div class="ttdoc">Holds configuration parameters for a feature detector.</div><div class="ttdef"><b>Definition:</b> <a href="featuredetector_2FeatureDetector_8h_source.html#l00101">FeatureDetector.h:102</a></div></div>
</div><!-- fragment --><p >Modify parameters according to input image and detection requirements, create detector. Detector will first split the given WxH input image into cellSize x cellSize cells, detect Harris corner whose score is higher than scoreThreshold. Features with score &gt;= scoreThreshold will be considered as high frequency details (red crosses). Detail features will be added to candidate list first, detector will then sort the rest features with score between (scoreThreshold, detailThreshold) from highest to lowest by cell, select the first numEvenDistributionPerCell features in each cell (blue crosses, here numEvenDistributionPerCell = 5, so there're 5 second-highest-score features in each cell). These second-highest-score features are distributed evenly across cells. <img src="feature_tracker.png" alt="" class="inline"/>    </p>
<p >Setting scoreThreshold &gt;= detailThreshold means all features are high frequency details, numEvenDistributionPerCell will be invalid. Setting numEvenDistributionPerCell = 0 turns off the even distribution component. Both of the 2 cases will make detected features be clustered in high frequency regions, i.e. only red crosses will be left in above illustration. <code>contextHandle</code> is assumed to be previously initialized dwContextHandle_t. </p><div class="fragment"><div class="line">detectorConfig.<a class="code hl_variable" href="group__featureDetector__group.html#a8da7f953cbb56099235517259933eaf7">imageWidth</a>              = inputImageProps.width;</div>
<div class="line">detectorConfig.<a class="code hl_variable" href="group__featureDetector__group.html#a3364ab124887babb5dbbb7ccbbd71a65">imageHeight</a>             = inputImageProps.height;</div>
<div class="line">detectorConfig.<a class="code hl_variable" href="group__featureDetector__group.html#afc0d733db5ae20538408c34ffb52a560">scoreThreshold</a>          = scoreThreshold;</div>
<div class="line">detectorConfig.<a class="code hl_variable" href="group__featureDetector__group.html#afb93684f9795edd82120c22fa952bc0e">detailThreshold</a>         = detailThreshold;</div>
<div class="line">detectorConfig.<a class="code hl_variable" href="group__featureDetector__group.html#a7ee12328dc7741a0e631e7d693a80f48">cellSize</a>                = cellSize;</div>
<div class="line">detectorConfig.<a class="code hl_variable" href="group__featureDetector__group.html#a6d3c69e22a715afdd65194926bcb56f4">maxFeatureCount</a>         = maxFeatureCount;</div>
<div class="line">detectorConfig.<a class="code hl_variable" href="group__featureDetector__group.html#adb45e3b28964ec464e75382b00f51495">numEvenDistributionPerCell</a> = numEvenDistributionPerCell;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="group__featureDetector__group.html#gad15de8e32fc68dafe3f3cf824d6456c4">dwFeature2DDetector_initialize</a>(&amp;detector, &amp;detectorConfig, 0, contextHandle);</div>
<div class="ttc" id="agroup__featureDetector__group_html_a3364ab124887babb5dbbb7ccbbd71a65"><div class="ttname"><a href="group__featureDetector__group.html#a3364ab124887babb5dbbb7ccbbd71a65">dwFeature2DDetectorConfig::imageHeight</a></div><div class="ttdeci">uint32_t imageHeight</div><div class="ttdoc">Height of the images that the Detector runs on.</div><div class="ttdef"><b>Definition:</b> <a href="featuredetector_2FeatureDetector_8h_source.html#l00112">FeatureDetector.h:112</a></div></div>
<div class="ttc" id="agroup__featureDetector__group_html_a6d3c69e22a715afdd65194926bcb56f4"><div class="ttname"><a href="group__featureDetector__group.html#a6d3c69e22a715afdd65194926bcb56f4">dwFeature2DDetectorConfig::maxFeatureCount</a></div><div class="ttdeci">uint32_t maxFeatureCount</div><div class="ttdoc">Upper bound on number of features handled.</div><div class="ttdef"><b>Definition:</b> <a href="featuredetector_2FeatureDetector_8h_source.html#l00117">FeatureDetector.h:117</a></div></div>
<div class="ttc" id="agroup__featureDetector__group_html_a7ee12328dc7741a0e631e7d693a80f48"><div class="ttname"><a href="group__featureDetector__group.html#a7ee12328dc7741a0e631e7d693a80f48">dwFeature2DDetectorConfig::cellSize</a></div><div class="ttdeci">uint32_t cellSize</div><div class="ttdoc">Cell size in pixel to split the image into cells.</div><div class="ttdef"><b>Definition:</b> <a href="featuredetector_2FeatureDetector_8h_source.html#l00126">FeatureDetector.h:126</a></div></div>
<div class="ttc" id="agroup__featureDetector__group_html_a8da7f953cbb56099235517259933eaf7"><div class="ttname"><a href="group__featureDetector__group.html#a8da7f953cbb56099235517259933eaf7">dwFeature2DDetectorConfig::imageWidth</a></div><div class="ttdeci">uint32_t imageWidth</div><div class="ttdoc">Width of the images that the Detector runs on.</div><div class="ttdef"><b>Definition:</b> <a href="featuredetector_2FeatureDetector_8h_source.html#l00108">FeatureDetector.h:108</a></div></div>
<div class="ttc" id="agroup__featureDetector__group_html_adb45e3b28964ec464e75382b00f51495"><div class="ttname"><a href="group__featureDetector__group.html#adb45e3b28964ec464e75382b00f51495">dwFeature2DDetectorConfig::numEvenDistributionPerCell</a></div><div class="ttdeci">uint32_t numEvenDistributionPerCell</div><div class="ttdoc">for DW_FEATURE2D_DETECTOR_TYPE_STD only Number of features to be appended after high frequency points...</div><div class="ttdef"><b>Definition:</b> <a href="featuredetector_2FeatureDetector_8h_source.html#l00162">FeatureDetector.h:162</a></div></div>
<div class="ttc" id="agroup__featureDetector__group_html_afb93684f9795edd82120c22fa952bc0e"><div class="ttname"><a href="group__featureDetector__group.html#afb93684f9795edd82120c22fa952bc0e">dwFeature2DDetectorConfig::detailThreshold</a></div><div class="ttdeci">float32_t detailThreshold</div><div class="ttdoc">for DW_FEATURE2D_DETECTOR_TYPE_STD only features in the cell that have scores higher than this value ...</div><div class="ttdef"><b>Definition:</b> <a href="featuredetector_2FeatureDetector_8h_source.html#l00149">FeatureDetector.h:149</a></div></div>
<div class="ttc" id="agroup__featureDetector__group_html_afc0d733db5ae20538408c34ffb52a560"><div class="ttname"><a href="group__featureDetector__group.html#afc0d733db5ae20538408c34ffb52a560">dwFeature2DDetectorConfig::scoreThreshold</a></div><div class="ttdeci">float32_t scoreThreshold</div><div class="ttdoc">Threshold to filter out low latency points.</div><div class="ttdef"><b>Definition:</b> <a href="featuredetector_2FeatureDetector_8h_source.html#l00142">FeatureDetector.h:142</a></div></div>
<div class="ttc" id="agroup__featureDetector__group_html_gad15de8e32fc68dafe3f3cf824d6456c4"><div class="ttname"><a href="group__featureDetector__group.html#gad15de8e32fc68dafe3f3cf824d6456c4">dwFeature2DDetector_initialize</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwFeature2DDetector_initialize(dwFeature2DDetectorHandle_t *obj, const dwFeature2DDetectorConfig *config, cudaStream_t cudaStream, dwContextHandle_t context)</div><div class="ttdoc">Creates and initializes a feature Detector.</div></div>
</div><!-- fragment --><p >Modify parameters according to input image and tracking requirements, create tracker. <code>trackerConfig.isInputCompact</code> must be read from detector. <code>contextHandle</code> is assumed to be previously initialized dwContextHandle_t. </p><div class="fragment"><div class="line">trackerConfig.<a class="code hl_variable" href="group__feature2dtracker__group.html#adb9faa4d6ee021f2e31dc586a64d8109">imageWidth</a>              = inputImageProps.width;</div>
<div class="line">trackerConfig.<a class="code hl_variable" href="group__feature2dtracker__group.html#a99501e2875ea7cf32865ba59cf313b31">imageHeight</a>             = inputImageProps.height;</div>
<div class="line">trackerConfig.<a class="code hl_variable" href="group__feature2dtracker__group.html#a8c9a4082587e128c9a6945c599755b03">windowSizeLK</a>            = 10;</div>
<div class="line">trackerConfig.iterationsLK            = 10;</div>
<div class="line">trackerConfig.<a class="code hl_variable" href="group__feature2dtracker__group.html#a1b6c02a778efde9a85991497820a6c52">detectorType</a>            = detectorConfig.<a class="code hl_variable" href="group__featureDetector__group.html#ad421d1ad7e19cb03e04ce28b541da796">type</a>;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="group__feature2dtracker__group.html#ga338a09308a4534aa08482159895b7762">dwFeature2DTracker_initialize</a>(&amp;tracker, &amp;trackerConfig, 0, contextHandle);</div>
<div class="ttc" id="agroup__feature2dtracker__group_html_a1b6c02a778efde9a85991497820a6c52"><div class="ttname"><a href="group__feature2dtracker__group.html#a1b6c02a778efde9a85991497820a6c52">dwFeature2DTrackerConfig::detectorType</a></div><div class="ttdeci">dwFeature2DDetectorType detectorType</div><div class="ttdoc">Type of detector that connects to the tracker, should be the same value as dwFeature2DDetectorConfig:...</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTracker_8h_source.html#l00098">FeatureTracker.h:98</a></div></div>
<div class="ttc" id="agroup__feature2dtracker__group_html_a8c9a4082587e128c9a6945c599755b03"><div class="ttname"><a href="group__feature2dtracker__group.html#a8c9a4082587e128c9a6945c599755b03">dwFeature2DTrackerConfig::windowSizeLK</a></div><div class="ttdeci">uint32_t windowSizeLK</div><div class="ttdoc">Window size used in the KLT tracker.</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTracker_8h_source.html#l00126">FeatureTracker.h:126</a></div></div>
<div class="ttc" id="agroup__feature2dtracker__group_html_a99501e2875ea7cf32865ba59cf313b31"><div class="ttname"><a href="group__feature2dtracker__group.html#a99501e2875ea7cf32865ba59cf313b31">dwFeature2DTrackerConfig::imageHeight</a></div><div class="ttdeci">uint32_t imageHeight</div><div class="ttdoc">Height of the images that the tracker runs on.</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTracker_8h_source.html#l00116">FeatureTracker.h:116</a></div></div>
<div class="ttc" id="agroup__feature2dtracker__group_html_adb9faa4d6ee021f2e31dc586a64d8109"><div class="ttname"><a href="group__feature2dtracker__group.html#adb9faa4d6ee021f2e31dc586a64d8109">dwFeature2DTrackerConfig::imageWidth</a></div><div class="ttdeci">uint32_t imageWidth</div><div class="ttdoc">Width of the images that the tracker runs on.</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTracker_8h_source.html#l00113">FeatureTracker.h:113</a></div></div>
<div class="ttc" id="agroup__feature2dtracker__group_html_ga338a09308a4534aa08482159895b7762"><div class="ttname"><a href="group__feature2dtracker__group.html#ga338a09308a4534aa08482159895b7762">dwFeature2DTracker_initialize</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwFeature2DTracker_initialize(dwFeature2DTrackerHandle_t *obj, const dwFeature2DTrackerConfig *config, cudaStream_t cudaStream, dwContextHandle_t context)</div><div class="ttdoc">Creates and initializes a feature tracker.</div></div>
<div class="ttc" id="agroup__featureDetector__group_html_ad421d1ad7e19cb03e04ce28b541da796"><div class="ttname"><a href="group__featureDetector__group.html#ad421d1ad7e19cb03e04ce28b541da796">dwFeature2DDetectorConfig::type</a></div><div class="ttdeci">dwFeature2DDetectorType type</div><div class="ttdoc">Detecting algorithm defined by dwFeature2DDetectorType</div><div class="ttdef"><b>Definition:</b> <a href="featuredetector_2FeatureDetector_8h_source.html#l00104">FeatureDetector.h:104</a></div></div>
</div><!-- fragment --><p >Create 2 image pyramids as detection/tracking input: one is current, one is previous, the 2 pyramids work as a double buffer (or ping-pong buffer). They swap each other after each detection/tracking cycle. So new frame will always be read into pyrmaidCurrent and the previous frame will be stored to pyramidPrevious.</p>
<p ><code>dwPyramid_create</code> only creates pyramid image and allocates memory, pyramid will be filled in <code>dwImageFilter_computePyramid</code>. Top level (level 0) in pyramid is always the same size as original input image.</p>
<p ><code>inputImageProps.width</code>, <code>inputImageProps.height</code> are the same in tracker/detector initialization</p>
<p ><code>imagePxlType</code> should be got from <code>dwImage_getPixelType(inputImageProps.format)</code>.</p>
<p ><code>contextHandle</code> is assumed to be previously initialized dwContextHandle_t.</p>
<div class="fragment"><div class="line">dwPyramid_create(&amp;pyramidPrevious, levelCount,</div>
<div class="line">    inputImageProps.width, inputImageProps.height, pxlType, context);</div>
<div class="line"> </div>
<div class="line">dwPyramid_create(&amp;pyramidCurrent, levelCount,</div>
<div class="line">    inputImageProps.width, inputImageProps.height, pxlType,context);</div>
</div><!-- fragment --><h3>Create nccScore array on GPU</h3>
<div class="fragment"><div class="line">cudaMalloc(&amp;d_nccScores, maxFeatureCount * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="group__core__basictypes__group.html#ga4611b605e45ab401f02cab15c5e38715">float32_t</a>));</div>
<div class="ttc" id="agroup__core__basictypes__group_html_ga4611b605e45ab401f02cab15c5e38715"><div class="ttname"><a href="group__core__basictypes__group.html#ga4611b605e45ab401f02cab15c5e38715">float32_t</a></div><div class="ttdeci">float float32_t</div><div class="ttdoc">Specifies POD types.</div><div class="ttdef"><b>Definition:</b> <a href="BasicTypes_8h_source.html#l00057">BasicTypes.h:57</a></div></div>
</div><!-- fragment --><h3>Start tracking the loop</h3>
<div class="fragment"><div class="line"><span class="keywordflow">while</span>(<span class="keyword">true</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// ping-pong current/previous pyramid</span></div>
<div class="line">    <span class="comment">// so new frame will always be built in pyramidCurrent</span></div>
<div class="line">    <span class="comment">// and old pyramid will be stored in pyramidPrevious</span></div>
<div class="line">    std::swap(pyramidCurrent, pyramidPrevious);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// CODE: Read image frame code</span></div>
<div class="line">    <a class="code hl_typedef" href="group__image__group.html#ga0941eecdd67c03c4685bb895f0066f59">dwImageHandle_t</a> image = ...;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// compute pyramid based on the new read frame image</span></div>
<div class="line">    dwImageFilter_computePyramid(&amp;pyramidCurrent, image, 0, contextHandle);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// do tracking</span></div>
<div class="line">    <a class="code hl_struct" href="group__featureArray__group.html#structdwFeatureArray">dwFeatureArray</a> featurePredicted;</div>
<div class="line">    <a class="code hl_function" href="group__feature2dtracker__group.html#gaad84b8d7ede7ae10a20222c061021079">dwFeature2DTracker_trackFeatures</a>(&amp;featureHistoryGPU, &amp;featurePredicted,</div>
<div class="line">                                     d_nccScores, &amp;featuresDetected,</div>
<div class="line">                                     &amp;pyramidPrevious, &amp;pyramidCurrent, tracker)</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// detect new features in the current frame</span></div>
<div class="line">    <a class="code hl_function" href="group__featureDetector__group.html#ga85b864b1a1895f612d99c6870a1f9251">dwFeature2DDetector_detectFromImage</a>(&amp;featuresDetected, pyramidCurrent.levelImages[0],</div>
<div class="line">                                        &amp;featurePredicted, d_nccScores, detector)</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// copy detected results to CPU</span></div>
<div class="line">    dwFeatureHistoryArray_copy(&amp;featureHistoryCPU, &amp;featureHistoryGPU, 0);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// do some stuff in CPU</span></div>
<div class="line">    featureHistoryCPU.locationHistory[...];</div>
<div class="line">    featureHistoryCPU.statuses[...];</div>
<div class="line">}</div>
<div class="ttc" id="agroup__feature2dtracker__group_html_gaad84b8d7ede7ae10a20222c061021079"><div class="ttname"><a href="group__feature2dtracker__group.html#gaad84b8d7ede7ae10a20222c061021079">dwFeature2DTracker_trackFeatures</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwFeature2DTracker_trackFeatures(dwFeatureHistoryArray *featureHistoryArray, dwFeatureArray *predictedFeatures, float32_t *d_normalizedCrossCorrelation, const dwFeatureArray *featuresToTrack, const dwVector2f *d_predictedPositions, const dwPyramidImage *previousPyramid, const dwPyramidImage *currentPyramid, dwFeature2DTrackerHandle_t obj)</div><div class="ttdoc">Tracks features and store the tracked results to predictedFeatures between the previous and current i...</div></div>
<div class="ttc" id="agroup__featureArray__group_html_structdwFeatureArray"><div class="ttname"><a href="group__featureArray__group.html#structdwFeatureArray">dwFeatureArray</a></div><div class="ttdef"><b>Definition:</b> <a href="FeatureList_8h_source.html#l00136">FeatureList.h:137</a></div></div>
<div class="ttc" id="agroup__featureDetector__group_html_ga85b864b1a1895f612d99c6870a1f9251"><div class="ttname"><a href="group__featureDetector__group.html#ga85b864b1a1895f612d99c6870a1f9251">dwFeature2DDetector_detectFromImage</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwFeature2DDetector_detectFromImage(dwFeatureArray *outputDetections, dwImageHandle_t image, dwFeatureArray *preTrackedFeatures, const float32_t *d_normalizedCrossCorrelation, dwFeature2DDetectorHandle_t obj)</div><div class="ttdoc">Detects new features and append them after old tracked features.</div></div>
<div class="ttc" id="agroup__image__group_html_ga0941eecdd67c03c4685bb895f0066f59"><div class="ttname"><a href="group__image__group.html#ga0941eecdd67c03c4685bb895f0066f59">dwImageHandle_t</a></div><div class="ttdeci">struct dwImageObject * dwImageHandle_t</div><div class="ttdef"><b>Definition:</b> <a href="image_2Image_8h_source.html#l00102">Image.h:102</a></div></div>
</div><!-- fragment --><h3>Finally, free previously allocated memory.</h3>
<div class="fragment"><div class="line">cudaFree(d_nccScores);</div>
<div class="line"> </div>
<div class="line">dwPyramid_destroy(pyramidPrevious);</div>
<div class="line">dwPyramid_destroy(pyramidCurrent);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="group__featureArray__group.html#ga212e03d3e504937744c141c0951d8bf5">dwFeatureHistoryArray_destroy</a>(featureHistoryCPU);</div>
<div class="line"><a class="code hl_function" href="group__featureArray__group.html#ga212e03d3e504937744c141c0951d8bf5">dwFeatureHistoryArray_destroy</a>(featureHistoryGPU);</div>
<div class="line"><a class="code hl_function" href="group__featureArray__group.html#gaad6d20a82ac080c06684ff69553cadab">dwFeatureArray_destroy</a>(featuresDetected);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="group__featureDetector__group.html#ga87fe2e9d78515bab9645984955a023a4">dwFeature2DDetector_release</a>(detector);</div>
<div class="line"><a class="code hl_function" href="group__feature2dtracker__group.html#gaac51ce50bf476989e7d3400a6a2b6345">dwFeature2DTracker_release</a>(tracker);</div>
<div class="ttc" id="agroup__feature2dtracker__group_html_gaac51ce50bf476989e7d3400a6a2b6345"><div class="ttname"><a href="group__feature2dtracker__group.html#gaac51ce50bf476989e7d3400a6a2b6345">dwFeature2DTracker_release</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwFeature2DTracker_release(dwFeature2DTrackerHandle_t obj)</div><div class="ttdoc">Releases the feature tracker.</div></div>
<div class="ttc" id="agroup__featureArray__group_html_ga212e03d3e504937744c141c0951d8bf5"><div class="ttname"><a href="group__featureArray__group.html#ga212e03d3e504937744c141c0951d8bf5">dwFeatureHistoryArray_destroy</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwFeatureHistoryArray_destroy(dwFeatureHistoryArray featureHistoryArray)</div><div class="ttdoc">Destroys the featureHistoryArray and frees any memory created by dwFeatureHistoryArray_create().</div></div>
<div class="ttc" id="agroup__featureArray__group_html_gaad6d20a82ac080c06684ff69553cadab"><div class="ttname"><a href="group__featureArray__group.html#gaad6d20a82ac080c06684ff69553cadab">dwFeatureArray_destroy</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwFeatureArray_destroy(dwFeatureArray featureArray)</div><div class="ttdoc">Destroys the featureArray and frees any memory created by dwFeatureArray_create().</div></div>
<div class="ttc" id="agroup__featureDetector__group_html_ga87fe2e9d78515bab9645984955a023a4"><div class="ttname"><a href="group__featureDetector__group.html#ga87fe2e9d78515bab9645984955a023a4">dwFeature2DDetector_release</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwFeature2DDetector_release(dwFeature2DDetectorHandle_t obj)</div><div class="ttdoc">Releases the feature Detector.</div></div>
</div><!-- fragment --><p >For the full implementation refer to <a class="el" href="dwx_feature_tracker_sample.html">Feature Tracker Sample</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->

  <div id="nav-path" class="navpath">
    <ul>
      <li class="footer">
        Advance Information | Subject to Change |
        Prepared and Provided under NDA | Generated by NVIDIA |
        PR-08397-V5.0
      </li>
     </ul>
  </div>
</body>
</html>
