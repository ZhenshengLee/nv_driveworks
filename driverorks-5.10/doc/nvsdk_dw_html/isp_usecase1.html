<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!--
 * Copyright (c) 2009-2014 NVIDIA CORPORATION.  All rights reserved.
 *
 * NVIDIA Corporation and its licensors retain all intellectual property
 * and proprietary rights in and to this software, related documentation
 * and any modifications thereto.  Any use, reproduction, disclosure or
 * distribution of this software and related documentation without an express
 * license agreement from NVIDIA Corporation is strictly prohibited.
-->
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<title>DriveWorks SDK Reference: Software ISP Workflow</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="Nvidia.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="reverb-search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="nv.css" rel="stylesheet" type="text/css" />
<link href="nvdwx.css" rel="stylesheet" type="text/css"/>
<style>
 body {
 background-position: 350px 150px;
 background-image: url(watermark.png);
 background-repeat: no-repeat;
 background-attachment: fixed;
 }
 </style>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table width="99%" border="0" cellspacing="1" cellpadding="1">
  <tbody>
    <tr valign="middle">
      <td rowspan="2" height="44" width="19%">
        <div>
            <a id="nv-logo" href="https://www.nvidia.com/"></a>
        </div>
      <td width="81%" height="44">
        <div style="text-align:right; font-weight: bold; font-size:20px"> <br/>DriveWorks SDK Reference </div>
        <div style="text-align:right">
        5.10.87 Release <br/> For Test and Development only <br/> <br/> </div>
    </td>
  </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('isp_usecase1.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Software ISP Workflow </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >This workflow is demonstrated in the following sample: <a class="el" href="dwx_camera_replay_sample.html">Camera Replay Sample</a></p>
<p >Initialize the parameters using a camera as input.</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="group__soft__ISP.html#structdwSoftISPParams">dwSoftISPParams</a> softISPParams;</div>
<div class="line"><a class="code hl_function" href="group__soft__ISP.html#ga08805729f48f2e332f09928ca5a15fca">dwSoftISP_initParamsFromCamera</a>(&amp;softISPParams, &amp;cameraProps);</div>
<div class="ttc" id="agroup__soft__ISP_html_ga08805729f48f2e332f09928ca5a15fca"><div class="ttname"><a href="group__soft__ISP.html#ga08805729f48f2e332f09928ca5a15fca">dwSoftISP_initParamsFromCamera</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwSoftISP_initParamsFromCamera(dwSoftISPParams *params, const dwCameraProperties *cameraProps)</div><div class="ttdoc">Initializes the parameters for the softISP using dwCameraProperties.</div></div>
<div class="ttc" id="agroup__soft__ISP_html_structdwSoftISPParams"><div class="ttname"><a href="group__soft__ISP.html#structdwSoftISPParams">dwSoftISPParams</a></div><div class="ttdef"><b>Definition:</b> <a href="SoftISP_8h_source.html#l00113">SoftISP.h:114</a></div></div>
</div><!-- fragment --><p >Initialize the softISP module</p>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="group__soft__ISP.html#gaef7ce7dd7865e1d6d46c30e4044417d1">dwSoftISPHandle_t</a> softISP;</div>
<div class="line"><a class="code hl_function" href="group__soft__ISP.html#gaaaad042521a48b79cd5e2e331bb937eb">dwSoftISP_initialize</a>(&amp;softISP, &amp;softISPParams, sdk);</div>
<div class="ttc" id="agroup__soft__ISP_html_gaaaad042521a48b79cd5e2e331bb937eb"><div class="ttname"><a href="group__soft__ISP.html#gaaaad042521a48b79cd5e2e331bb937eb">dwSoftISP_initialize</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwSoftISP_initialize(dwSoftISPHandle_t *obj, const dwSoftISPParams *params, const dwContextHandle_t ctx)</div><div class="ttdoc">Creates and initializes the software ISP pipeline.</div></div>
<div class="ttc" id="agroup__soft__ISP_html_gaef7ce7dd7865e1d6d46c30e4044417d1"><div class="ttname"><a href="group__soft__ISP.html#gaef7ce7dd7865e1d6d46c30e4044417d1">dwSoftISPHandle_t</a></div><div class="ttdeci">struct dwSoftISPObject * dwSoftISPHandle_t</div><div class="ttdoc">Handle representing the Software ISP.</div><div class="ttdef"><b>Definition:</b> <a href="SoftISP_8h_source.html#l00081">SoftISP.h:81</a></div></div>
</div><!-- fragment --><p >Set the demosaic method and crop region. The choice of demosaic method will affect the resolution of the output</p>
<div class="fragment"><div class="line"><a class="code hl_function" href="group__soft__ISP.html#ga4405b6a2762da6434f1057e40b8fa505">dwSoftISP_setDemosaicMethod</a>(<a class="code hl_enumvalue" href="group__soft__ISP.html#ggaebafefa5330cac7abde176f685617749ac2a409169c1db714556e7a78b6ef1e9a">DW_SOFTISP_DEMOSAIC_METHOD_INTERPOLATION</a>, softISP);</div>
<div class="line"><a class="code hl_function" href="group__soft__ISP.html#ga499ccbc5f04a88eea59a6d47cbbadd9b">dwSoftISP_setDemosaicROI</a>(cropRegion, softISP); <span class="comment">// optional</span></div>
<div class="ttc" id="agroup__soft__ISP_html_ga4405b6a2762da6434f1057e40b8fa505"><div class="ttname"><a href="group__soft__ISP.html#ga4405b6a2762da6434f1057e40b8fa505">dwSoftISP_setDemosaicMethod</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwSoftISP_setDemosaicMethod(dwSoftISPDemosaicMethod method, dwSoftISPHandle_t obj)</div><div class="ttdoc">Sets the method used to demosaic.</div></div>
<div class="ttc" id="agroup__soft__ISP_html_ga499ccbc5f04a88eea59a6d47cbbadd9b"><div class="ttname"><a href="group__soft__ISP.html#ga499ccbc5f04a88eea59a6d47cbbadd9b">dwSoftISP_setDemosaicROI</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwSoftISP_setDemosaicROI(dwRect cropRegion, dwSoftISPHandle_t obj)</div><div class="ttdoc">Sets the cropping region in the Bayer image used for demosaicing.</div></div>
<div class="ttc" id="agroup__soft__ISP_html_ggaebafefa5330cac7abde176f685617749ac2a409169c1db714556e7a78b6ef1e9a"><div class="ttname"><a href="group__soft__ISP.html#ggaebafefa5330cac7abde176f685617749ac2a409169c1db714556e7a78b6ef1e9a">DW_SOFTISP_DEMOSAIC_METHOD_INTERPOLATION</a></div><div class="ttdeci">@ DW_SOFTISP_DEMOSAIC_METHOD_INTERPOLATION</div><div class="ttdoc">Full camera resolution using interpolation.</div><div class="ttdef"><b>Definition:</b> <a href="SoftISP_8h_source.html#l00085">SoftISP.h:85</a></div></div>
</div><!-- fragment --><p >Get the properties for demosaic image (RCB image) and use them to create a CUDA image, which will be used as the output surface.</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="group__image__group.html#structdwImageProperties">dwImageProperties</a> rcbProperties;</div>
<div class="line"><a class="code hl_function" href="group__soft__ISP.html#ga4381160edd18ccf8c5011c1692ad42a9">dwSoftISP_getDemosaicImageProperties</a>(&amp;rcbProperties, softISP);</div>
<div class="line"><a class="code hl_typedef" href="group__image__group.html#ga0941eecdd67c03c4685bb895f0066f59">dwImageHandle_t</a> rcbImage = <a class="code hl_define" href="group__core__types__group.html#ga6caa500e64263b826a1e242a20cc02cc">DW_NULL_HANDLE</a>;</div>
<div class="line"><a class="code hl_function" href="group__image__group.html#ga8e16c1f43bb5f86cd4dc024d97fd3c5c">dwImage_create</a>(&amp;rcbImage, rcbProperties, sdk);</div>
<div class="line"><a class="code hl_struct" href="group__image__group.html#structdwImageCUDA">dwImageCUDA</a>* rcbImageCUDA = <span class="keyword">nullptr</span>;</div>
<div class="line"><a class="code hl_function" href="group__image__group.html#ga9b63aaeb03d9cbda4fec269ec09f53e6">dwImage_getCUDA</a>(&amp;rcbImageCUDA, rcbImage);</div>
<div class="line"><a class="code hl_function" href="group__soft__ISP.html#gad795049fd36092c99366bb2a1ab6df4e">dwSoftISP_bindOutputDemosaic</a>(rcbImageCUDA, softISP);</div>
<div class="ttc" id="agroup__core__types__group_html_ga6caa500e64263b826a1e242a20cc02cc"><div class="ttname"><a href="group__core__types__group.html#ga6caa500e64263b826a1e242a20cc02cc">DW_NULL_HANDLE</a></div><div class="ttdeci">#define DW_NULL_HANDLE</div><div class="ttdef"><b>Definition:</b> <a href="Types_8h_source.html#l00083">Types.h:83</a></div></div>
<div class="ttc" id="agroup__image__group_html_ga0941eecdd67c03c4685bb895f0066f59"><div class="ttname"><a href="group__image__group.html#ga0941eecdd67c03c4685bb895f0066f59">dwImageHandle_t</a></div><div class="ttdeci">struct dwImageObject * dwImageHandle_t</div><div class="ttdef"><b>Definition:</b> <a href="image_2Image_8h_source.html#l00102">Image.h:102</a></div></div>
<div class="ttc" id="agroup__image__group_html_ga8e16c1f43bb5f86cd4dc024d97fd3c5c"><div class="ttname"><a href="group__image__group.html#ga8e16c1f43bb5f86cd4dc024d97fd3c5c">dwImage_create</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwImage_create(dwImageHandle_t *const image, dwImageProperties properties, dwContextHandle_t const ctx)</div><div class="ttdoc">Creates and allocates resources for a dwImageHandle_t based on the properties passed as input.</div></div>
<div class="ttc" id="agroup__image__group_html_ga9b63aaeb03d9cbda4fec269ec09f53e6"><div class="ttname"><a href="group__image__group.html#ga9b63aaeb03d9cbda4fec269ec09f53e6">dwImage_getCUDA</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwImage_getCUDA(dwImageCUDA **const imageCUDA, dwImageHandle_t const image)</div><div class="ttdoc">Retrieves the dwImageCUDA of a dwImageHandle_t.</div></div>
<div class="ttc" id="agroup__image__group_html_structdwImageCUDA"><div class="ttname"><a href="group__image__group.html#structdwImageCUDA">dwImageCUDA</a></div><div class="ttdoc">Defines a CUDA image.</div><div class="ttdef"><b>Definition:</b> <a href="image_2Image_8h_source.html#l00419">Image.h:420</a></div></div>
<div class="ttc" id="agroup__image__group_html_structdwImageProperties"><div class="ttname"><a href="group__image__group.html#structdwImageProperties">dwImageProperties</a></div><div class="ttdoc">Defines the properties of the image.</div><div class="ttdef"><b>Definition:</b> <a href="image_2Image_8h_source.html#l00389">Image.h:390</a></div></div>
<div class="ttc" id="agroup__soft__ISP_html_ga4381160edd18ccf8c5011c1692ad42a9"><div class="ttname"><a href="group__soft__ISP.html#ga4381160edd18ccf8c5011c1692ad42a9">dwSoftISP_getDemosaicImageProperties</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwSoftISP_getDemosaicImageProperties(dwImageProperties *imageProperties, dwSoftISPHandle_t obj)</div><div class="ttdoc">Gets the image properties for the produced demosaiced images.</div></div>
<div class="ttc" id="agroup__soft__ISP_html_gad795049fd36092c99366bb2a1ab6df4e"><div class="ttname"><a href="group__soft__ISP.html#gad795049fd36092c99366bb2a1ab6df4e">dwSoftISP_bindOutputDemosaic</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwSoftISP_bindOutputDemosaic(dwImageCUDA *demosaicImage, dwSoftISPHandle_t obj)</div><div class="ttdoc">Binds a demosaic image to the softISP.</div></div>
</div><!-- fragment --><p >Allocate an RGBA CUDA image for the tone map output. Given that there are multiple choices for format, there is no API that returns tone map properties, but the user chooses (the choice is limited)</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="group__image__group.html#structdwImageProperties">dwImageProperties</a> rgbaImageProperties = rcbProperties;</div>
<div class="line">rgbaImageProperties.<a class="code hl_variable" href="group__image__group.html#ab0797520b7b3e416db1cacee3dc4b567">format</a>         = <a class="code hl_enumvalue" href="group__image__group.html#ggab7343d2f61d8450ef8451d4ec73d087ca3bd3c4e72a8ef0652237783a22d1fd29">DW_IMAGE_FORMAT_RGBA_UINT8</a>;</div>
<div class="line"><span class="comment">// CODE: create image with rgbaProperties</span></div>
<div class="line"><a class="code hl_function" href="group__soft__ISP.html#ga499751abb07a0bf063119bc619c9d5e0">dwSoftISP_bindOutputTonemap</a>(rgbaImageCUDA, softISP);</div>
<div class="ttc" id="agroup__image__group_html_ab0797520b7b3e416db1cacee3dc4b567"><div class="ttname"><a href="group__image__group.html#ab0797520b7b3e416db1cacee3dc4b567">dwImageProperties::format</a></div><div class="ttdeci">dwImageFormat format</div><div class="ttdoc">Specifies the format of the image.</div><div class="ttdef"><b>Definition:</b> <a href="image_2Image_8h_source.html#l00398">Image.h:398</a></div></div>
<div class="ttc" id="agroup__image__group_html_ggab7343d2f61d8450ef8451d4ec73d087ca3bd3c4e72a8ef0652237783a22d1fd29"><div class="ttname"><a href="group__image__group.html#ggab7343d2f61d8450ef8451d4ec73d087ca3bd3c4e72a8ef0652237783a22d1fd29">DW_IMAGE_FORMAT_RGBA_UINT8</a></div><div class="ttdeci">@ DW_IMAGE_FORMAT_RGBA_UINT8</div><div class="ttdef"><b>Definition:</b> <a href="image_2Image_8h_source.html#l00144">Image.h:144</a></div></div>
<div class="ttc" id="agroup__soft__ISP_html_ga499751abb07a0bf063119bc619c9d5e0"><div class="ttname"><a href="group__soft__ISP.html#ga499751abb07a0bf063119bc619c9d5e0">dwSoftISP_bindOutputTonemap</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwSoftISP_bindOutputTonemap(dwImageCUDA *tonemappedImage, dwSoftISPHandle_t obj)</div><div class="ttdoc">Binds a tone-mapped image to the softISP.</div></div>
</div><!-- fragment --><p >Main loop, reads the camera frame, retrieves a CUDA image of the raw input, binds it to the soft ISP and gets processed. All outputs are now found in the respective bound image, namely rcbImage and rgbaImage</p>
<div class="fragment"><div class="line"><span class="keywordflow">while</span>(loop) {</div>
<div class="line">    <span class="comment">// CODE: read raw from camera</span></div>
<div class="line">    <a class="code hl_function" href="group__soft__ISP.html#ga4b3549be99b631a5118b70623c078b86">dwSoftISP_bindInputRaw</a>(rawImageCUDA, softISP);</div>
<div class="line">    <a class="code hl_function" href="group__soft__ISP.html#ga2b5f6fd5b5cc6f34eaa9b5d8821304c2">dwSoftISP_processDeviceAsync</a>(<a class="code hl_enumvalue" href="group__soft__ISP.html#gga3c373db621330f67e20f447ff0e09cf8a6ead3a5567675b56204af951a2ef136c">DW_SOFTISP_PROCESS_TYPE_DEMOSAIC</a> | <a class="code hl_enumvalue" href="group__soft__ISP.html#gga3c373db621330f67e20f447ff0e09cf8a54d7ff3f15abef12f514c856ede80c39">DW_SOFTISP_PROCESS_TYPE_TONEMAP</a>, softISP);</div>
<div class="line">    <span class="comment">// CODE: use either or both rcbImage and rgbaImage</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__soft__ISP_html_ga2b5f6fd5b5cc6f34eaa9b5d8821304c2"><div class="ttname"><a href="group__soft__ISP.html#ga2b5f6fd5b5cc6f34eaa9b5d8821304c2">dwSoftISP_processDeviceAsync</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwSoftISP_processDeviceAsync(dwSoftISPHandle_t obj)</div><div class="ttdoc">Runs the Software ISP to convert the bound raw image into whatever output was bound beforehand.</div></div>
<div class="ttc" id="agroup__soft__ISP_html_ga4b3549be99b631a5118b70623c078b86"><div class="ttname"><a href="group__soft__ISP.html#ga4b3549be99b631a5118b70623c078b86">dwSoftISP_bindInputRaw</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwSoftISP_bindInputRaw(const dwImageCUDA *rawImage, dwSoftISPHandle_t obj)</div><div class="ttdoc">Binds the input image to the softISP.</div></div>
<div class="ttc" id="agroup__soft__ISP_html_gga3c373db621330f67e20f447ff0e09cf8a54d7ff3f15abef12f514c856ede80c39"><div class="ttname"><a href="group__soft__ISP.html#gga3c373db621330f67e20f447ff0e09cf8a54d7ff3f15abef12f514c856ede80c39">DW_SOFTISP_PROCESS_TYPE_TONEMAP</a></div><div class="ttdeci">@ DW_SOFTISP_PROCESS_TYPE_TONEMAP</div><div class="ttdoc">Compute tone map.</div><div class="ttdef"><b>Definition:</b> <a href="SoftISP_8h_source.html#l00103">SoftISP.h:103</a></div></div>
<div class="ttc" id="agroup__soft__ISP_html_gga3c373db621330f67e20f447ff0e09cf8a6ead3a5567675b56204af951a2ef136c"><div class="ttname"><a href="group__soft__ISP.html#gga3c373db621330f67e20f447ff0e09cf8a6ead3a5567675b56204af951a2ef136c">DW_SOFTISP_PROCESS_TYPE_DEMOSAIC</a></div><div class="ttdeci">@ DW_SOFTISP_PROCESS_TYPE_DEMOSAIC</div><div class="ttdoc">Compute demosaic.</div><div class="ttdef"><b>Definition:</b> <a href="SoftISP_8h_source.html#l00101">SoftISP.h:101</a></div></div>
</div><!-- fragment --><p >All images allocated are destroyed and dwSoftISP released</p>
<div class="fragment"><div class="line"><span class="comment">// CODE: destroy images</span></div>
<div class="line"><a class="code hl_function" href="group__soft__ISP.html#ga0d41f636f2214517358aa6161fdc5d16">dwSoftISP_release</a>(&amp;rccb);</div>
<div class="ttc" id="agroup__soft__ISP_html_ga0d41f636f2214517358aa6161fdc5d16"><div class="ttname"><a href="group__soft__ISP.html#ga0d41f636f2214517358aa6161fdc5d16">dwSoftISP_release</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwSoftISP_release(dwSoftISPHandle_t obj)</div><div class="ttdoc">Releases the softISP pipeline object.</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->

  <div id="nav-path" class="navpath">
    <ul>
      <li class="footer">
        Advance Information | Subject to Change |
        Prepared and Provided under NDA | Generated by NVIDIA |
        PR-08397-V5.0
      </li>
     </ul>
  </div>
</body>
</html>
