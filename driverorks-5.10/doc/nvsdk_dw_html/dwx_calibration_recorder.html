<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!--
 * Copyright (c) 2009-2014 NVIDIA CORPORATION.  All rights reserved.
 *
 * NVIDIA Corporation and its licensors retain all intellectual property
 * and proprietary rights in and to this software, related documentation
 * and any modifications thereto.  Any use, reproduction, disclosure or
 * distribution of this software and related documentation without an express
 * license agreement from NVIDIA Corporation is strictly prohibited.
-->
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<title>DriveWorks SDK Reference: Static Calibration Recorder Tool</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="Nvidia.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="reverb-search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="nv.css" rel="stylesheet" type="text/css" />
<link href="nvdwx.css" rel="stylesheet" type="text/css"/>
<style>
 body {
 background-position: 350px 150px;
 background-image: url(watermark.png);
 background-repeat: no-repeat;
 background-attachment: fixed;
 }
 </style>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table width="99%" border="0" cellspacing="1" cellpadding="1">
  <tbody>
    <tr valign="middle">
      <td rowspan="2" height="44" width="19%">
        <div>
            <a id="nv-logo" href="https://www.nvidia.com/"></a>
        </div>
      <td width="81%" height="44">
        <div style="text-align:right; font-weight: bold; font-size:20px"> <br/>DriveWorks SDK Reference </div>
        <div style="text-align:right">
        5.10.87 Release <br/> For Test and Development only <br/> <br/> </div>
    </td>
  </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('dwx_calibration_recorder.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Static Calibration Recorder Tool </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#dwx_calibration_recorder_description">Description</a></li>
<li class="level1"><a href="#dwx_calibration_recorder_prerequisites">Prerequisites</a></li>
<li class="level1"><a href="#dwx_calibration_recorder_run-command">Running the Tool</a><ul><li class="level2"><a href="#dwx_calibration_recorder_parameters">Parameters</a></li>
<li class="level2"><a href="#dwx_calibration_recorder_usage">Usage</a></li>
</ul>
</li>
<li class="level1"><a href="#dwx_calibration_recorder_output">Output</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="dwx_calibration_recorder_description"></a>
Description</h1>
<p >The Static Calibration Recorder Tool can be used to capture the data that is required by the <a class="el" href="dwx_calibration_graph_cli.html">Graph Calibration Tool</a>. It takes a rig file as input and renders the live video streams of the rig's cameras. In "Extrinsics Mode" it allows to capture and store images from those camera video streams. In "Intrinsics Mode", the intrinsics constraints created by checkerboard marker detections are accumulated and can be stored to .json files that are required for further processing in the static camera calibration tool. If the camera's intrinsics are available from its EEPROM, the intrinsics will be read from there and stored in the corresponding .json file. In that case, it is not necessary to capture intrinsics constraints. If the camera has an intrinsics model assigned, it will be displayed in the panel of the "Intrinsics Mode". The rig file can contain camera parameters for live camera access, or file paths to recorded files. Alternatively, when working with video files, a single video file can be provided instead of a rig file.</p>
<h1><a class="anchor" id="dwx_calibration_recorder_prerequisites"></a>
Prerequisites</h1>
<p >This tool is available on the x86 Host System and NVIDIA DRIVE<sup>&trade;</sup> OS Linux.</p>
<h1><a class="anchor" id="dwx_calibration_recorder_run-command"></a>
Running the Tool</h1>
<p >Run the tool by executing: </p><pre class="fragment">/calibration-recorder --rig=[path to rig file]
                      --targetDB=[path to targets.json file]
                      --output=[path to directory where new directories "intrinsics" / "extrinsics" (or "extrinsics_&lt;number&gt;" if "external" already exists) are created to store the results]
</pre> <h2><a class="anchor" id="dwx_calibration_recorder_parameters"></a>
Parameters</h2>
<pre class="fragment">--rig=[path to rig file]
        Description: Rig file containing the cameras.
        Example: --rig=rig.json

--video=[path to video file]
        Video to be loaded as a virtual camera. This parameter is ignored if a rig is provided.
        Example: --video=camera.mp4

--targetDB=[path to target database json file]
        Description: Path to json file with apriltag target description. AprilTag detection is disabled if not provided.
        Example: --targetDB=targets.json

--mode=[extrinsics / intrinsics]
        Description: Optional. Set mode enabled at startup. (extrinsics / intrinsics)
        Example: --mode=extrinsics

--checkerboard=[&lt;width&gt;x&lt;height&gt;]
        Description: Optional. Set count of checkerboard squares at startup.
        Example: --checkerboard=14x9

--output=[path to output directory]
        Description: Directory in which the 'extrinsics' / 'intrinsics' output folders are created to store results
        Example: --output=/tmp/calibration-data

--cameraSensorFifoSize=[number of frames in camera sensor fifo]
        Description: Optional. Use a small value (minimum 1) to use less GPU memory. Use larger values to avoid frame drops. (Experimental Feature)
        Example: --cameraSensorFifoSize=4
</pre> <h2><a class="anchor" id="dwx_calibration_recorder_usage"></a>
Usage</h2>
<p >Image files with frame captures and .json files with intrinsics constraints, each withing their subdirectory "extrinsics" or "intrinsics" are stored to the output directory when clicking the "Capture" button or pressing the "Enter" key. The output directory can be specified via command line parameter, by pasting a path into the corresponding UI, or by drag and dropping a directory onto the tool.</p>
<p >There is a UI to select the cameras to be rendered simultanously. This allows to observe and control the placement of calibration markers in the scene. When clicking on a camera while holding the control key, that camera is selected exclusively. See <a class="el" href="dwx_camera_calibration.html#dwx_camera_calibration_setup">2 Scene Setup</a> for more details on how to setup the scene for extrinsics.</p>
<div class="image">
<img src="tool_calibration-recorder_extrinsics.png" alt=""/>
</div>
    <p >In "Intrinsics Mode", intrinsics constraints are accumulated for the enabled cameras when target detection is enabled. All currently accumulated intrinsics constraint points are rendered overlayed onto the live image as red dots. The number of currently collected intrinsics constraints are printed in parentheses next to the camera name. The points of the current target detection are rendered in green. In order to collect a constraint, the target has to be held still for a moment. Once the constraints have been collected at a position, the rendered dots of the current detection turn blue. When this happens, the target can be moved to the next pose. The detection-dots turn green again once the target has been moved sufficiently far away from the previously collected constraint. See <a class="el" href="dwx_camera_calibration.html#dwx_camera_calibration_data_int">3.1 Capturing Data for Intrinsic Camera Calibration</a> for more details about how to capture intrinsics constraints.</p>
<div class="image">
<img src="tool_calibration-recorder_intrinsics.png" alt=""/>
</div>
    <p >The results are stored to .json files when the "Save" button in the UI or the "Enter" key is pressed. If there are unsaved instrinsics constraints at program exit, they get saved to disk as well.</p>
<p >An intrinsics calibration can be performed on selected cameras with their currently collected constraints by pressing the "Calibrate" button. The resulting camera model parameters will then be printed to both the console and in the UI panel. If a camera model is available in the camera's EEPROM, it will be read from there. The camera model will be saved to the intrinsics .json file, together with the collected intrinsics constraints, or just by itself without constraints if none have been collected. It is not required to collect constraints if a model is already available. The <a class="el" href="dwx_calibration_graph_cli.html">Graph Calibration Tool</a> tool will then use both the constraints and the existing camera model in its calibration process.</p>
<p >There is an option to select if and which images to store together with the intrinsics constraints for debugging and archiving purposes. By default, all frames for which an instrinsics constraint is collected are stored. It is possible to additionally store images where a target has been detected, but the detection is not used as a constraint. Finally, there's an option to store all processed frames, that is including also frames where no checkerboard is recorded.</p>
<p >If the targetDB parameter is omitted, AprilTag detection is not available, however checkerboard detection for intrinsics and frame capturing for extrinsics images is still possible.</p>
<h1><a class="anchor" id="dwx_calibration_recorder_output"></a>
Output</h1>
<p >In "Extrinsics Mode" the tool outputs a screenshot for each camera listed in the rig. It creates a directory called "extrinsics" (as these captures are intended to be used for extrinsic camera calibration). If such a directory already exists, a suffix '_&lt;number&gt;' is appended to create a non-existing directory path. This avoids overwriting existing data. The capture images are stored inside that new directory as files named '&lt;camera name&gt;.png'. Similarly, in "Intrinsics Mode" the tool outputs a .json file with intrinsics constraints for each camera. If no intrinsics constraints are available for a camera, no file is written. Optionally, images files are stored for each constraint in the .json file. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->

  <div id="nav-path" class="navpath">
    <ul>
      <li class="footer">
        Advance Information | Subject to Change |
        Prepared and Provided under NDA | Generated by NVIDIA |
        PR-08397-V5.0
      </li>
     </ul>
  </div>
</body>
</html>
