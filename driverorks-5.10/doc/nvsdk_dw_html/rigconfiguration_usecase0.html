<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!--
 * Copyright (c) 2009-2014 NVIDIA CORPORATION.  All rights reserved.
 *
 * NVIDIA Corporation and its licensors retain all intellectual property
 * and proprietary rights in and to this software, related documentation
 * and any modifications thereto.  Any use, reproduction, disclosure or
 * distribution of this software and related documentation without an express
 * license agreement from NVIDIA Corporation is strictly prohibited.
-->
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<title>DriveWorks SDK Reference: Rig File Format</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="Nvidia.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="reverb-search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="nv.css" rel="stylesheet" type="text/css" />
<link href="nvdwx.css" rel="stylesheet" type="text/css"/>
<style>
 body {
 background-position: 350px 150px;
 background-image: url(watermark.png);
 background-repeat: no-repeat;
 background-attachment: fixed;
 }
 </style>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table width="99%" border="0" cellspacing="1" cellpadding="1">
  <tbody>
    <tr valign="middle">
      <td rowspan="2" height="44" width="19%">
        <div>
            <a id="nv-logo" href="https://www.nvidia.com/"></a>
        </div>
      <td width="81%" height="44">
        <div style="text-align:right; font-weight: bold; font-size:20px"> <br/>DriveWorks SDK Reference </div>
        <div style="text-align:right">
        5.10.87 Release <br/> For Test and Development only <br/> <br/> </div>
    </td>
  </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('rigconfiguration_usecase0.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Rig File Format </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >A rig file contains two major fields to define sensors and vehicles, that is, </p><pre class="fragment">{
    "rig": {
        "sensors": [ { sensor I }, { sensor II }, ... ],
        "vehicle": { vehicle }
    },
    "version":
}
</pre> <h1><a class="anchor" id="SensorField"></a>
Sensor Field</h1>
<p >Each sensor field provides information on each sensor and can be categorized into two types: camera field and non-camera field.</p>
<h2><a class="anchor" id="CameraField"></a>
1. Camera Field</h2>
<p >Each camera field is an array that describes each specific camera in the sensor suite. The following code snippet shows how the camera field is structured, </p><pre class="fragment">{
    "name": "camera:front:center:60fov",
    "nominalSensor2Rig": {
        "quaternion": [
            0.0,
            0.0,
            0.0,
            1.0
        ],
        "t": [
            0.0,
            0.0,
            0.0
        ]
    },
    "parameter": "camera-name=SF3325,interface=csi-a,link=0,output-format=raw+yuv,fifo-size=1,warn-per-frame=0",
    "properties": {
        "Model": "ftheta",
        "bw-poly": "0.0 0.000545421498827636 -1.6216719633103e-10 -4.64720492990289e-12 2.85224527762934e-16",
        "cx": "960",
        "cy": "604",
        "height": "1208",
        "width": "1920",
        "car-mask": "camera:front:center:60fov.pgm"
    },
    "protocol": "camera.gmsl",
    "sensor2Rig": {
        "quaternion": [
            0.0,
            0.0,
            0.0,
            1.0
        ],
        "t": [
            0.0,
            0.0,
            0.0
        ]
    },
    "car-mask": {
        "data/rle16-base64": "//8BjoABAQAA3QEBBQAA2gEBBwAA2AEBC...",
        "resolution": [
             480,
             302
        ]
}
</pre><p> <b>name</b>: <em>camera</em> : <em>front</em> | <em>rear</em> : <em>left</em> | <em>center</em> | <em>right</em> : <em>60fov</em> | <em>120fov</em></p>
<p ><b>parameter</b>: <a class="el" href="dwx_sensor_enum_sample.html">camera parameters</a></p>
<p ><b>properties</b>: Properties are stored in name=value pairs and implement properties which are specific for a certain sensor in a generic way. A camera can specify calibration parameters, e.g. the intrinsic parameters, in here.</p>
<p ><b>properties-&gt;Model</b>: <em>ftheta</em> | <em>ocam</em> | <em>pinhole</em></p>
<p >This determines the supported optical camera models, which defines the mapping between optical rays and pixel coordinates. Each model has a separate set of parameters <code><a class="el" href="group__rig__configuration__group.html#structdwFThetaCameraConfig" title="DEPRECATED: Configuration parameters for a calibrated FTheta camera.">dwFThetaCameraConfig</a></code>, <code>dwOCamCameraConfig</code>, <code><a class="el" href="group__rig__configuration__group.html#structdwPinholeCameraConfig">dwPinholeCameraConfig</a></code>.</p>
<p ><b>car-mask</b>: The <code>car-mask</code> <em>property</em> specifies a (optional) binary image file (currently <code>.pgm</code> images are supported) representing a binary mask of the ego-car in the camera image, separating it from the scene. Also, (optional) serialized car mask images are supported, which are represented by a serialization of the binary car mask images in the <code>car-mask</code> <em>field</em>. A <code>car-mask</code> image file property will be converted into a <code>car-mask</code> field on rig file serialization, and <code>car-mask</code> image file properties always have precedence over serialized car masks (to be able to update them). Car masks are important for, e.g., accurate self-calibration of the given camera.</p>
<p ><b>protocol</b>: For camera sensors, protocol must be <em>camera.gmsl</em></p>
<p ><a class="anchor" id="sensor2Rig"></a></p>
<h3><a class="anchor" id="sensor2rig"></a>
sensor2Rig:</h3>
<p >This is the sensor to rig transformation for a camera, and can be represented in two forms,</p>
<p >1. </p><pre class="fragment">{
    "quaternion": [q_x, q_y, q_z, q_w],
    "t": [t_x, t_y, t_z]
}
</pre><p >2. </p><pre class="fragment">{
    "roll-pitch-yaw": [roll, pitch, yaw],
    "t": [t_x, t_y, t_z]
}
</pre><p> This transformation relates the camera and the rig coordinate system to each other, i.e. translation in meters and roll-pitch-yaw in degrees. For example, the origin in camera coordinate system is the position of the camera in rig coordinates. The self-calibration might remove this field, and substitute it with <em>correction_rig_T</em> and <em>correction_sensor_R_FLU</em> transformations after the calibration.</p>
<p ><a class="anchor" id="nominalSensor2Rig"></a></p>
<h3><a class="anchor" id="nominalSensor2Rig"></a>
nominalSensor2Rig</h3>
<p >This is the nominal sensor to rig transformation for a camera, and can be represented in two forms,</p>
<p >1. </p><pre class="fragment">{
    "quaternion": [q_x, q_y, q_z, q_w],
    "t": [t_x, t_y, t_z]
}
</pre><p> 2. </p><pre class="fragment">{
    "roll-pitch-yaw": [roll, pitch, yaw],
    "t": [t_x, t_y, t_z]
}
</pre><p> This transformation differs from <em>sensor2rig</em> transformation in that it represents a static reference transformation from factory calibration and/or mechanical drawings, whereas <em>sensor2rig</em> can change over time.</p>
<p ><a class="anchor" id="correction_rig_T"></a></p>
<h3><a class="anchor" id="correction_rig_T"></a>
correction_rig_T</h3>
<p >This shows the corrections in the translation with respect to the <em>nominalSensor2Rig</em> transformation, which is estimated and added to the rig file by the self-calibration. The self-calibration saves the translation updates only as, </p><pre class="fragment">{
    "t": [t_x, t_y, t_z]
}
</pre><p> <a class="anchor" id="correction_sensor_R_FLU"></a></p>
<h3><a class="anchor" id="correction_sensor_R_FLU"></a>
correction_sensor_R_FLU</h3>
<p >This shows the corrections in the rotation with respect to the <em>nominalSensor2Rig</em> transformation, which is estimated and added to the rig file by the self-calibration. The self-calibration saves the rotation updates only as, </p><pre class="fragment">{
    "roll-pitch-yaw": [roll, pitch, yaw],
}
</pre><p> <a class="anchor" id="nominalSensor2Rig_FLU"></a></p>
<h3><a class="anchor" id="nominalSensor2Rig_FLU"></a>
nominalSensor2Rig_FLU</h3>
<p >During the self-calibration, <em>nominalSensor2Rig</em> transformation is renamed and saved as <em>nominalSensor2Rig_FLU</em> without any change in the values as, </p><pre class="fragment">{
    "roll-pitch-yaw": [roll, pitch, yaw],
    "t": [t_x, t_y, t_z]
}
</pre> <dl class="section note"><dt>Note</dt><dd>To summarize the self-calibration changes in the rig files,<ul>
<li>Rig files before self-calibration: <em>sensor2Rig</em> + <em>nominalSensor2Rig</em></li>
<li>Rig files after self-calibration: <em>correction_sensor_R_FLU</em> + <em>correction_rig_T</em> + <em>nominalSensor2Rig_FLU</em></li>
</ul>
</dd></dl>
<h2>2. Non-Camera Field</h2>
<p >NVIDIA<sup>&reg;</sup> DriveWorks currently supports the following non-camera sensors:</p><ul>
<li>CAN</li>
<li>GPS</li>
<li>IMU</li>
<li>Lidar</li>
<li>Radar</li>
</ul>
<p >The following code snippet shows an example for the IMU sensor field, </p><pre class="fragment">{
    "name": "imu:xsens",
    "nominalSensor2Rig": {
        "quaternion": [
            0.0,
            0.0,
            0.0,
            1.0
        ],
        "t": [
            0.0,
            0.0,
            0.0
        ]
    },
    "parameter": "device=/dev/ttyUSBXSENS,baudrate=230400,time-smoothing=true",
    "properties": null,
    "protocol": "imu.xsens",
    "sensor2Rig": {
        "quaternion": [
            0.0,
            0.0,
            0.0,
            1.0
        ],
        "t": [
            0.0,
            0.0,
            0.0
        ]
    }
}
</pre><p> The following code snippet shows an example for the GPS sensor field, </p><pre class="fragment">{
    "name": "gps:xsens",
    "correction_rig_T": [
        0.0,
        0.0,
        0.0
    ],
    "correction_sensor_R_FLU": {
        "roll-pitch-yaw": [
            0.0,
            0.0,
            0.0
        ]
    },
    "nominalSensor2Rig_FLU": {
        "roll-pitch-yaw": [
            0.0,
            0.0,
            0.0
        ],
        "t": [
            0.0,
            0.0,
            0.0
        ]
    },
    "parameter": "file=device=/dev/ttyUSBXSENS,baudrate=230400",
    "properties": null,
    "protocol": "gps.xsens"
}
</pre><p> <b>name</b>: <em>can</em> | <em>gps</em> | <em>imu</em> | <em>lidar</em> | <em>radar</em></p>
<p ><b>parameter</b>: <a class="el" href="dwx_sensor_enum_sample.html">sensor parameters</a></p>
<p ><b>properties</b>:</p>
<p >Properties are stored in name=value pairs and implement properties which are specific for a certain sensor in a generic way. For example, an IMU might store bias values there, etc.</p>
<p ><b>protocol</b>:</p>
<ul>
<li>CAN: <em>can.socket</em> | <em>can.aurix</em></li>
<li>GPS: <em>gps.uart</em> | <em>gps.xsens</em></li>
<li>IMU: <em>imu.uart</em> | <em>imu.xsens</em></li>
<li>Lidar: <em>lidar.socket</em></li>
<li>Radar: <em>radar.socket</em></li>
</ul>
<p ><b>sensor2Rig</b>: <a class="el" href="rigconfiguration_usecase0.html#sensor2rig">sensor2Rig transformation</a></p>
<p ><b>nominalSensor2Rig</b>: <a class="el" href="rigconfiguration_usecase0.html#nominalSensor2Rig">nominalSensor2Rig transformation</a></p>
<p ><b>correction_rig_T</b>: <a class="el" href="rigconfiguration_usecase0.html#correction_rig_T">correction_rig_T transformation</a></p>
<p ><b>correction_sensor_R_FLU</b>: <a class="el" href="rigconfiguration_usecase0.html#correction_sensor_R_FLU">correction_sensor_R_FLU transformation</a></p>
<p ><b>nominalSensor2Rig_FLU</b>: <a class="el" href="rigconfiguration_usecase0.html#nominalSensor2Rig_FLU">nominalSensor2Rig_FLU transformation</a></p>
<h1>Vehicle Field</h1>
<p >The following rig snippet shows the vehicle field structure, </p><pre class="fragment">{
    "vehicle": {
        "valid": true,
        "value": {
            "axleFront": {
                "corneringStiffness": 0.0,
                "position": 0.0,
                "track": 0.0,
                "wheelRadiusLeft": 0.0,
                "wheelRadiusRight": 0.0
            },
            "axleRear": {
                "corneringStiffness": 0.0,
                "position": 0.0,
                "track": 0.0,
                "wheelRadiusLeft": 0.0,
                "wheelRadiusRight": 0.0
            },
            "body": {
                "boundingBoxPosition": [0.0, 0.0, 0.0],
                "centerOfMass": [0.0, 0.0, 0.0],
                "height": 0.0,
                "inertia": [0.0, 0.0, 0.0],
                "length": 0.0,
                "mass": 0.0,
                "width": 0.0
            },
            "powertrain": {
                "brakeActuatorTimeConstant": 0.0,
                "effectiveMass": 0.0,
                "throttleActuatorTimeConstant": 0.0,
                "torqueLUT": {
                    "throttlePedalInput": "0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0",
                    "throttleSpeedInput": "0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0",
                    "throttleTorqueOutput": [
                        "0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0",
                        "0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0",
                        "0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0",
                        "0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0",
                        "0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0",
                        "0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0",
                        "0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0",
                        "0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0",
                        "0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0",
                        "0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0",
                        "0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0",
                        "0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0",
                        "0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0",
                        "0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0",
                        "0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0"
                    ],
                    "brakePedalInput": "0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0",
                    "brakeTorqueOutput": "0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0"
                }
            },
            "steering": {
                "driveByWireTimeConstant": 0.0,
                "driveByWireTimeDelay": 0.0,
                "maxSteeringWheelAngle": 0.0,
                "steeringWheelToSteeringMap": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
            },
            "suspension": {
                "pitchDampingRatio": 0.0,
                "pitchNaturalFrequency": 0.0
            },
            "hasCabin": false,
            "numTrailers": 0
        }
    }
}
</pre><p> For the full implementation refer to <code>dwVehicleGeneric</code></p>
<h1>Vehicle IO Field</h1>
<p >Vehicle IO field describes Drive-By-Wire interface of a vehicle. </p><pre class="fragment">"vehicleio": [
    {
        "type": "custom",
        "parent-sensor": "can:vehicle",
        "dbc-file": "AutonomousVehicleCANSignals.dbc"
    }
],
"sensors": [
    {
        "name": "can:vehicle",
        "parameter": "device=can0",
        "protocol": "can.socket",
        "properties": null,
        "nominalSensor2Rig": { "quaternion": [ 0.0, 0.0, 0.0, 1.0 ], "t": [ 0.0, 0.0, 0.0 ] },
        "sensor2Rig": { "quaternion": [ 0.0, 0.0, 0.0, 1.0 ], "t": [ 0.0, 0.0, 0.0 ] }
    }
],
</pre><p> <b>type</b>: <a class="el" href="vehicleio_mainsection.html">Type of a Drive-By-Wire interface.</a></p>
<p ><b>parent-sensor</b>: Name of a sensor that is used to communicate with Drive-By-Wire hardware.</p>
<p ><b>dbc-file</b>: A DBC file for Vehicle IO drivers that require one.</p>
<p >For more information, please refer to <a class="el" href="vehicleio_mainsection.html">Vehicle IO Documentation</a>, <a class="el" href="dwx_vehicleio_sample.html">Vehicle IO Sample</a>, and <a class="el" href="dwx_vehicleio_plugin_sample.html">Vehicle IO Plugin sample</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->

  <div id="nav-path" class="navpath">
    <ul>
      <li class="footer">
        Advance Information | Subject to Change |
        Prepared and Provided under NDA | Generated by NVIDIA |
        PR-08397-V5.0
      </li>
     </ul>
  </div>
</body>
</html>
