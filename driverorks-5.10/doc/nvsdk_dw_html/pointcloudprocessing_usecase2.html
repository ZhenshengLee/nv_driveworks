<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!--
 * Copyright (c) 2009-2014 NVIDIA CORPORATION.  All rights reserved.
 *
 * NVIDIA Corporation and its licensors retain all intellectual property
 * and proprietary rights in and to this software, related documentation
 * and any modifications thereto.  Any use, reproduction, disclosure or
 * distribution of this software and related documentation without an express
 * license agreement from NVIDIA Corporation is strictly prohibited.
-->
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<title>DriveWorks SDK Reference: Point Cloud Accumulator</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="Nvidia.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="reverb-search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="nv.css" rel="stylesheet" type="text/css" />
<link href="nvdwx.css" rel="stylesheet" type="text/css"/>
<style>
 body {
 background-position: 350px 150px;
 background-image: url(watermark.png);
 background-repeat: no-repeat;
 background-attachment: fixed;
 }
 </style>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table width="99%" border="0" cellspacing="1" cellpadding="1">
  <tbody>
    <tr valign="middle">
      <td rowspan="2" height="44" width="19%">
        <div>
            <a id="nv-logo" href="https://www.nvidia.com/"></a>
        </div>
      <td width="81%" height="44">
        <div style="text-align:right; font-weight: bold; font-size:20px"> <br/>DriveWorks SDK Reference </div>
        <div style="text-align:right">
        5.10.87 Release <br/> For Test and Development only <br/> <br/> </div>
    </td>
  </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('pointcloudprocessing_usecase2.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Point Cloud Accumulator </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >This tutorial demonstrates how to accumulate <code><a class="el" href="group__lidar__group.html#structdwLidarDecodedPacket" title="Defines the structure for a decoded lidar packet.">dwLidarDecodedPacket</a></code> to a Lidar spin according to the properties specified in <code><a class="el" href="group__lidar__group.html#structdwLidarProperties" title="Defines the properties of the lidar.">dwLidarProperties</a></code>.</p>
<p >Initialize the point cloud accumulator:</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="group__pointcloudaccumulator__group.html#structdwPointCloudAccumulatorParams">dwPointCloudAccumulatorParams</a> params{};</div>
<div class="line"><a class="code hl_typedef" href="group__pointcloudaccumulator__group.html#ga0c80e54352b3b675d35cc1702839ed8b">dwPointCloudAccumulatorHandle_t</a> accumulator;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="group__pointcloudaccumulator__group.html#ga117355d874d1c000b378c030c1380e0e">dwPointCloudAccumulator_getDefaultParams</a>(&amp;params);</div>
<div class="line">params.filterWindowSize         = 1;</div>
<div class="line">params.minAngleDegree           = -180.f;</div>
<div class="line">params.maxAngleDegree           = 180.f;</div>
<div class="line">params.minDistanceMeter         = 0.f;</div>
<div class="line">params.maxDistanceMeter         = FLT_MAX;</div>
<div class="line">params.memoryType               = <a class="code hl_enumvalue" href="group__core__types__group.html#gga71b04af11695393d59ac9aca72f93023ac9656206fa925a04a1a14bdfa5ab6a40">DW_MEMORY_TYPE_CUDA</a>;</div>
<div class="line">params.organized                = <span class="keyword">true</span>;</div>
<div class="line">params.enableMotionCompensation = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="group__pointcloudaccumulator__group.html#ga8ec959025cf7555674c76e557d68f933">dwPointCloudAccumulator_initialize</a>(&amp;accumulator, &amp;params, lidarProperties, context);</div>
<div class="ttc" id="agroup__core__types__group_html_gga71b04af11695393d59ac9aca72f93023ac9656206fa925a04a1a14bdfa5ab6a40"><div class="ttname"><a href="group__core__types__group.html#gga71b04af11695393d59ac9aca72f93023ac9656206fa925a04a1a14bdfa5ab6a40">DW_MEMORY_TYPE_CUDA</a></div><div class="ttdeci">@ DW_MEMORY_TYPE_CUDA</div><div class="ttdoc">CUDA memory.</div><div class="ttdef"><b>Definition:</b> <a href="Types_8h_source.html#l00178">Types.h:178</a></div></div>
<div class="ttc" id="agroup__pointcloudaccumulator__group_html_ga0c80e54352b3b675d35cc1702839ed8b"><div class="ttname"><a href="group__pointcloudaccumulator__group.html#ga0c80e54352b3b675d35cc1702839ed8b">dwPointCloudAccumulatorHandle_t</a></div><div class="ttdeci">struct dwPointCloudAccumulatorObject * dwPointCloudAccumulatorHandle_t</div><div class="ttdef"><b>Definition:</b> <a href="PointCloudAccumulator_8h_source.html#l00058">PointCloudAccumulator.h:58</a></div></div>
<div class="ttc" id="agroup__pointcloudaccumulator__group_html_ga117355d874d1c000b378c030c1380e0e"><div class="ttname"><a href="group__pointcloudaccumulator__group.html#ga117355d874d1c000b378c030c1380e0e">dwPointCloudAccumulator_getDefaultParams</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwPointCloudAccumulator_getDefaultParams(dwPointCloudAccumulatorParams *params)</div><div class="ttdoc">Gets default point cloud accumulator parameters.</div></div>
<div class="ttc" id="agroup__pointcloudaccumulator__group_html_ga8ec959025cf7555674c76e557d68f933"><div class="ttname"><a href="group__pointcloudaccumulator__group.html#ga8ec959025cf7555674c76e557d68f933">dwPointCloudAccumulator_initialize</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwPointCloudAccumulator_initialize(dwPointCloudAccumulatorHandle_t *obj, const dwPointCloudAccumulatorParams *accumulationParams, const dwLidarProperties *lidarProperties, dwContextHandle_t ctx)</div><div class="ttdoc">Initializes point cloud accumulator.</div></div>
<div class="ttc" id="agroup__pointcloudaccumulator__group_html_structdwPointCloudAccumulatorParams"><div class="ttname"><a href="group__pointcloudaccumulator__group.html#structdwPointCloudAccumulatorParams">dwPointCloudAccumulatorParams</a></div><div class="ttdoc">Defines point cloud accumulator parameters.</div><div class="ttdef"><b>Definition:</b> <a href="PointCloudAccumulator_8h_source.html#l00069">PointCloudAccumulator.h:70</a></div></div>
</div><!-- fragment --><p> <code>filterWinSize</code> specifies the horizontal smoothing for the Lidar sweep to reduce the horizontal jitter inherent to the Lidar rotating units. It must be set to be the power of 2 whose exponent ranges from 0 to 4. When set to values other than 1, the Lidar point whose 3D distance is the closest to the Lidar sensor is selected in the horizontal window.</p>
<p ><code>minAngleDegree</code>, <code>maxAngleDegree</code> parameters specify angle range to accumulate points. By default the module returns full 360-degree Lidar sweep.</p>
<p ><code>minDistanceMeter</code>, <code>maxDistanceMeter</code> parameters allows to customize the range of distance in a 360-degree Lidar sweep.</p>
<p ><code>params.type</code> specifies whether the accumulator works on CPU or GPU.</p>
<p >User can also set <code>params.memoryType = <a class="el" href="group__core__types__group.html#gga71b04af11695393d59ac9aca72f93023a9729e85945ecb1a598a445897aeb545c" title="pageable CPU memory">DW_MEMORY_TYPE_CPU</a></code> if CPU memory is expected. Organized point cloud resemble 2D grid which can be indexed by row and column. The organized nature brings up neighborhood relationship which could reduce computational costs for certain tasks. If <code>params.organized = false</code>, such neighborhood relationship is not maintained in the accumulated point cloud. If <code>params.enableMotionCompensation = true</code>, the accumulator will correct the motion distortion during the packet collection. User must initialize <code>params.egomotion</code> with valid egomotion handle. See <a class="el" href="egomotion_usecase1.html">Relative Egomotion Workflow</a> for egomotion usecase.</p>
<p >The sample specifies CUDA memory in the initialization, user is assumed to allocate CUDA memory to store the output, bind the buffer to the module and set the proper CUDA stream</p>
<div class="fragment"><div class="line"><a class="code hl_function" href="group__pointcloudaccumulator__group.html#ga72fee8be2a453117c0aa6ede27e40aff">dwPointCloudAccumulator_bindOutput</a>(&amp;accumulatedSpin, accumulator);</div>
<div class="line"><a class="code hl_function" href="group__pointcloudaccumulator__group.html#ga914c2fb6a462e7f297fc1c0b1a3ab8e8">dwPointCloudAccumulator_setCUDAStream</a>(stream, accumulator);</div>
<div class="ttc" id="agroup__pointcloudaccumulator__group_html_ga72fee8be2a453117c0aa6ede27e40aff"><div class="ttname"><a href="group__pointcloudaccumulator__group.html#ga72fee8be2a453117c0aa6ede27e40aff">dwPointCloudAccumulator_bindOutput</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwPointCloudAccumulator_bindOutput(dwPointCloud *pointCloud, dwPointCloudAccumulatorHandle_t obj)</div><div class="ttdoc">Binds output point cloud buffer.</div></div>
<div class="ttc" id="agroup__pointcloudaccumulator__group_html_ga914c2fb6a462e7f297fc1c0b1a3ab8e8"><div class="ttname"><a href="group__pointcloudaccumulator__group.html#ga914c2fb6a462e7f297fc1c0b1a3ab8e8">dwPointCloudAccumulator_setCUDAStream</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwPointCloudAccumulator_setCUDAStream(const cudaStream_t stream, dwPointCloudAccumulatorHandle_t obj)</div><div class="ttdoc">Sets CUDA stream of point cloud accumulator.</div></div>
</div><!-- fragment --><p >To continuously collect the decoded lidar packet until is reaches the packets per spin specified in <code><a class="el" href="group__lidar__group.html#structdwLidarProperties" title="Defines the properties of the lidar.">dwLidarProperties</a></code>:</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> hasFullSpinReady = <span class="keyword">false</span>;</div>
<div class="line"><a class="code hl_function" href="group__pointcloudaccumulator__group.html#ga67d95bfca8e1497a85b638dfe415f174">dwPointCloudAccumulator_isReady</a>(&amp;hasFullSpinReady, accumulator);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">while</span> (!hasFullSpinReady)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// get decoded lidar packet</span></div>
<div class="line">    ......</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="group__pointcloudaccumulator__group.html#ga1da61ff7202d8ac1ba2eba318afd2fb1">dwPointCloudAccumulator_addLidarPacket</a>(lidarPacket, accumulator);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="group__pointcloudaccumulator__group.html#ga67d95bfca8e1497a85b638dfe415f174">dwPointCloudAccumulator_isReady</a>(&amp;hasFullSpinReady, accumulator);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">cudaStreamSynchronize(stream);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// use accumulatedSpin for other tasks</span></div>
<div class="line">......</div>
<div class="ttc" id="agroup__pointcloudaccumulator__group_html_ga1da61ff7202d8ac1ba2eba318afd2fb1"><div class="ttname"><a href="group__pointcloudaccumulator__group.html#ga1da61ff7202d8ac1ba2eba318afd2fb1">dwPointCloudAccumulator_addLidarPacket</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwPointCloudAccumulator_addLidarPacket(const dwLidarDecodedPacket *packet, dwPointCloudAccumulatorHandle_t obj)</div><div class="ttdoc">Pushes lidar packet to point cloud accumulator.</div></div>
<div class="ttc" id="agroup__pointcloudaccumulator__group_html_ga67d95bfca8e1497a85b638dfe415f174"><div class="ttname"><a href="group__pointcloudaccumulator__group.html#ga67d95bfca8e1497a85b638dfe415f174">dwPointCloudAccumulator_isReady</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwPointCloudAccumulator_isReady(bool *isReady, dwPointCloudAccumulatorHandle_t obj)</div><div class="ttdoc">Indicate that enough data has been collected to perform full combination.</div></div>
</div><!-- fragment --><p >To release the module:</p>
<div class="fragment"><div class="line"><a class="code hl_function" href="group__pointcloudaccumulator__group.html#gac90de69dc13fb77b60e595b14929e7ee">dwPointCloudAccumulator_release</a>(accumulator);</div>
<div class="ttc" id="agroup__pointcloudaccumulator__group_html_gac90de69dc13fb77b60e595b14929e7ee"><div class="ttname"><a href="group__pointcloudaccumulator__group.html#gac90de69dc13fb77b60e595b14929e7ee">dwPointCloudAccumulator_release</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwPointCloudAccumulator_release(dwPointCloudAccumulatorHandle_t obj)</div><div class="ttdoc">Releases point cloud accumulator.</div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>output buffer <code>accumulatedSpin</code> should have the same memory type as <code>params.memoryType</code>.</dd></dl>
<p>For more details see <a class="el" href="dwx_pointcloudprocessing_sample.html">Point Cloud Processing Sample</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->

  <div id="nav-path" class="navpath">
    <ul>
      <li class="footer">
        Advance Information | Subject to Change |
        Prepared and Provided under NDA | Generated by NVIDIA |
        PR-08397-V5.0
      </li>
     </ul>
  </div>
</body>
</html>
