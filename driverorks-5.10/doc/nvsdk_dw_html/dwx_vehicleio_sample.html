<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!--
 * Copyright (c) 2009-2014 NVIDIA CORPORATION.  All rights reserved.
 *
 * NVIDIA Corporation and its licensors retain all intellectual property
 * and proprietary rights in and to this software, related documentation
 * and any modifications thereto.  Any use, reproduction, disclosure or
 * distribution of this software and related documentation without an express
 * license agreement from NVIDIA Corporation is strictly prohibited.
-->
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<title>DriveWorks SDK Reference: VehicleIO Sample</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="Nvidia.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="reverb-search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="nv.css" rel="stylesheet" type="text/css" />
<link href="nvdwx.css" rel="stylesheet" type="text/css"/>
<style>
 body {
 background-position: 350px 150px;
 background-image: url(watermark.png);
 background-repeat: no-repeat;
 background-attachment: fixed;
 }
 </style>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table width="99%" border="0" cellspacing="1" cellpadding="1">
  <tbody>
    <tr valign="middle">
      <td rowspan="2" height="44" width="19%">
        <div>
            <a id="nv-logo" href="https://www.nvidia.com/"></a>
        </div>
      <td width="81%" height="44">
        <div style="text-align:right; font-weight: bold; font-size:20px"> <br/>DriveWorks SDK Reference </div>
        <div style="text-align:right">
        5.10.87 Release <br/> For Test and Development only <br/> <br/> </div>
    </td>
  </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('dwx_vehicleio_sample.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">VehicleIO Sample </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#dwx_vehicleio_description">Description</a></li>
<li class="level1"><a href="#dwx_vehicleio_running">Running the Sample</a><ul><li class="level2"><a href="#dwx_vehicleio_examples">Examples</a></li>
</ul>
</li>
<li class="level1"><a href="#dwx_vehicleio_output">Output</a></li>
<li class="level1"><a href="#dwx_vehicleio_more">Additional information</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="dwx_vehicleio_description"></a>
Description</h1>
<p >The VehicleIO sample demonstrates how to read and write the state of the vehicle actuators (i.e. throttle, brake, steering, etc.) It can talk to different vehicle control systems, one of which is Dataspeed. The <a class="el" href="vehicleio_mainsection.html">VehicleIO</a> module abstracts the underlying physical protocols and connections. The internal "driver layer" handles the protocol interface and the VehicleIO module handles the state.</p>
<p >The VehicleIO sample has been tested with CAN-based Dataspeed vehicle control system and validated with Ford MKZ and Ford Fusion vehicles. To send the steering, brake or throttle commands, use a keyboard or a USB joystick (tested with Logitech Gamepad F310).</p>
<p >The VehicleIO sample can run with the Dataspeed drive-by-wire (DbW) systems. It can also run with a generic NVIDIA DbW driver. The <code>AutonomousVehicleCANSignals.dbc</code> DBC file describes the CAN commands for that driver.</p>
<p >If you run the vehicleIO sample with the generic driver, you must also run the DataspeedBridge utility. That utility converts the CAN messages and commands to/from DbW systems to a generic type.</p>
<h1><a class="anchor" id="dwx_vehicleio_running"></a>
Running the Sample</h1>
<p >The command line for the sample is: </p><pre class="fragment">./sample_vehicleio [--rig=path/to/rig/file] [--allow-no-safety=[no|yes]]
</pre><p> where </p><pre class="fragment">--rig=[path/to/rig/file]
    Points to the rig file.
    Default value: path/to/data/samples/samples/vehicleio/rig.json

--allow-no-safety=[no|yes]
    Set to 'yes' to allow issuing actuation commands without
    software-imposed limits.
    Default value: no
</pre><p> While the sample is running, the following commands are available:</p>
<ul>
<li>E - enable the vehicle control system</li>
<li>D - disable the vehicle control system</li>
<li>Arrow key UP - incrementel throttle with every arrow key UP press</li>
<li>Arrow key DOWN - incremental braking with every arrow key DOWN press</li>
<li>Arrow key LEFT - incremental steering rotation (counter-clockwise) with every key press</li>
<li>Arrow key RIGHT - incremental steering rotation (clockwise) with every key press</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The vehicle control system is only available when using real CAN or linux VCAN.</dd></dl>
<h2><a class="anchor" id="dwx_vehicleio_examples"></a>
Examples</h2>
<h4>Run VehicleIO sample with the Dataspeed driver</h4>
<p >To use with the pre-recorded CAN data, which is provided with the sample, run the sample without any arguments: </p><pre class="fragment">./sample_vehicleio
</pre><p> To use a custom pre-recorded CAN data or to run live, one should provide a custom rig file and use <code>--rig</code> argument: </p><pre class="fragment">./sample_vehicleio --rig=rig.json
</pre><p> One can use the provided (default) rig.json file as a template (exact location of that file can be found using <code>./sample_vehicleio --help</code>.)</p>
<h4>Run VehicleIO sample with the generic DbW Driver</h4>
<p >Before you can run the sample with a generic driver, you must run the utility DataspeedBridge. This sample converts the messages from Dataspeed to a generic type and vice-versa.</p>
<p >You can use the CAN0 interface in a vehicle equipped with the Dataspeed DbW system. With that setup, you can use the generic vehicleIO driver directly in a CAR, where the Dataspeed system is connected to CAN0.</p>
<p >The following steps assume your DbW system is connected to CAN0.</p>
<p >After running the dataspeedBridge, run the vehicleio sample with a Rig Configuration that has only generic VehicleIO node:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    &quot;rig&quot;: {</div>
<div class="line">        &quot;vehicleio&quot;: [</div>
<div class="line">            {</div>
<div class="line">                &quot;type&quot;: &quot;generic&quot;,</div>
<div class="line">                &quot;parent-sensor&quot;: &quot;can:vehicle:generic&quot;,</div>
<div class="line">                &quot;dbc-file&quot;: &quot;AutonomousVehicleCANSignals.dbc&quot;</div>
<div class="line">            }</div>
<div class="line">        ],</div>
<div class="line">        &quot;sensors&quot;: [</div>
<div class="line">            {</div>
<div class="line">                &quot;name&quot;: &quot;can:vehicle:generic&quot;,</div>
<div class="line">                &quot;parameter&quot;: &quot;device=can0&quot;,</div>
<div class="line">                &quot;protocol&quot;: &quot;can.socket&quot;,</div>
<div class="line">                &quot;properties&quot;: null,</div>
<div class="line">                &quot;nominalSensor2Rig&quot;: { &quot;quaternion&quot;: [ 0.0, 0.0, 0.0, 1.0 ], &quot;t&quot;: [ 0.0, 0.0, 0.0 ] },</div>
<div class="line">                &quot;sensor2Rig&quot;: { &quot;quaternion&quot;: [ 0.0, 0.0, 0.0, 1.0 ], &quot;t&quot;: [ 0.0, 0.0, 0.0 ] }</div>
<div class="line">            }</div>
<div class="line">        ],</div>
<div class="line">...</div>
<div class="line">}</div>
</div><!-- fragment --><p >Then run the sample with this new rig.json file: </p><pre class="fragment">./sample_vehicleio --rig=rig.json
</pre> <h4>Using Generic VehicleIO via VCAN0 interface on Bench</h4>
<p >If you want to use the generic vehicleio driver in a bench setup, you can use the VCAN interface.</p>
<ol type="1">
<li>Enable the VCAN interface. <pre class="fragment">sudo modprobe vcan
sudo ip link add dev vcan0 type vcan
sudo ip link set up vcan0
</pre></li>
<li>Start transmitting Dataspeed can messages over the VCAN interface. <pre class="fragment">while true; do cat candump_dataspeed.log | canplayer -l i vcan0=can0; done
</pre></li>
<li>Run <code>sample_dataspeedBridge</code> to convert Dataspeed messages to generic vehicleio messages (refer to <a class="el" href="dwx_dataspeedBridge_sample.html">Dataspeed Bridge Sample</a> for details).</li>
<li>Prepare a rig file that has vcan0 sensor and Generic VehicleIO node (as described above), then run the sample: <pre class="fragment">./sample_vehicleio --rig=rig.json
</pre> </li>
</ol>
<h1><a class="anchor" id="dwx_vehicleio_output"></a>
Output</h1>
<p >The sample opens a window to display the various vehicle control parameters, such as throttle, braking, and steering. Once the window is in the focus, the throttle, brakes, steering of the vehicle can be controlled via a keyboard or a USB joystick, as described above.</p>
<p >The sample prints the basic vehicle state information to the terminal.</p>
<div class="image">
<img src="sample_vehicleio.png" alt=""/>
<div class="caption">
VehicleIO sample</div></div>
    <h1><a class="anchor" id="dwx_vehicleio_more"></a>
Additional information</h1>
<p >For more information, see <a class="el" href="vehicleio_mainsection.html">VehicleIO</a> . </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->

  <div id="nav-path" class="navpath">
    <ul>
      <li class="footer">
        Advance Information | Subject to Change |
        Prepared and Provided under NDA | Generated by NVIDIA |
        PR-08397-V5.0
      </li>
     </ul>
  </div>
</body>
</html>
