<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!--
 * Copyright (c) 2009-2014 NVIDIA CORPORATION.  All rights reserved.
 *
 * NVIDIA Corporation and its licensors retain all intellectual property
 * and proprietary rights in and to this software, related documentation
 * and any modifications thereto.  Any use, reproduction, disclosure or
 * distribution of this software and related documentation without an express
 * license agreement from NVIDIA Corporation is strictly prohibited.
-->
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<title>DriveWorks SDK Reference: Sensor Timestamping</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="Nvidia.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="reverb-search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="nv.css" rel="stylesheet" type="text/css" />
<link href="nvdwx.css" rel="stylesheet" type="text/css"/>
<style>
 body {
 background-position: 350px 150px;
 background-image: url(watermark.png);
 background-repeat: no-repeat;
 background-attachment: fixed;
 }
 </style>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table width="99%" border="0" cellspacing="1" cellpadding="1">
  <tbody>
    <tr valign="middle">
      <td rowspan="2" height="44" width="19%">
        <div>
            <a id="nv-logo" href="https://www.nvidia.com/"></a>
        </div>
      <td width="81%" height="44">
        <div style="text-align:right; font-weight: bold; font-size:20px"> <br/>DriveWorks SDK Reference </div>
        <div style="text-align:right">
        5.10.87 Release <br/> For Test and Development only <br/> <br/> </div>
    </td>
  </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('sensors_usecase4.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Sensor Timestamping </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >One of the critical aspects of data acquisition on systems with multiple sensors for real-time processing is to obtain accurate timestamping of the data. NVIDIA<sup>&reg;</sup> DriveWorks relies on the system time source of Xavier, in particular, the CLOCK_MONOTONIC time source. This time source adjusted to the UNIX epoch time is used internally to timestamp all sensors and events, and the application can get the current time via the function:</p>
<div class="fragment"><div class="line"><a class="code hl_enumeration" href="group__core__status__group.html#ga01e41060986cf4c0d618a8923846619b">dwStatus</a> <a class="code hl_function" href="group__core__context__group.html#gac4e68bd18ac8a47c804832feecb3d533">dwContext_getCurrentTime</a>(<a class="code hl_typedef" href="group__core__basictypes__group.html#gac4840df46df4be80c7f427057740af65">dwTime_t</a> *time, <a class="code hl_typedef" href="group__core__context__group.html#gae81934046206143539721bbe30b08a1e">dwContextHandle_t</a> ctx);</div>
<div class="ttc" id="agroup__core__basictypes__group_html_gac4840df46df4be80c7f427057740af65"><div class="ttname"><a href="group__core__basictypes__group.html#gac4840df46df4be80c7f427057740af65">dwTime_t</a></div><div class="ttdeci">int64_t dwTime_t</div><div class="ttdoc">Specifies a timestamp unit, in microseconds.</div><div class="ttdef"><b>Definition:</b> <a href="BasicTypes_8h_source.html#l00063">BasicTypes.h:63</a></div></div>
<div class="ttc" id="agroup__core__context__group_html_gac4e68bd18ac8a47c804832feecb3d533"><div class="ttname"><a href="group__core__context__group.html#gac4e68bd18ac8a47c804832feecb3d533">dwContext_getCurrentTime</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwContext_getCurrentTime(dwTime_t *const time, dwContextHandle_t const context)</div><div class="ttdoc">Returns the current timestamp.</div></div>
<div class="ttc" id="agroup__core__context__group_html_gae81934046206143539721bbe30b08a1e"><div class="ttname"><a href="group__core__context__group.html#gae81934046206143539721bbe30b08a1e">dwContextHandle_t</a></div><div class="ttdeci">struct dwContextObject * dwContextHandle_t</div><div class="ttdoc">Context handle.</div><div class="ttdef"><b>Definition:</b> <a href="Context_8h_source.html#l00083">Context.h:83</a></div></div>
<div class="ttc" id="agroup__core__status__group_html_ga01e41060986cf4c0d618a8923846619b"><div class="ttname"><a href="group__core__status__group.html#ga01e41060986cf4c0d618a8923846619b">dwStatus</a></div><div class="ttdeci">dwStatus</div><div class="ttdoc">Status definition.</div><div class="ttdef"><b>Definition:</b> <a href="Status_8h_source.html#l00173">Status.h:173</a></div></div>
</div><!-- fragment --><p >Timestamps within the same context are guaranteed to be in sync. One thing to note is that this time source is relative to UNIX epoch time on Unix based platforms. Any NTP/PTP time corrections will influence this clock.</p>
<p >DriveWorks computes timestamps for each sensor when data arrives to the Xavier, so sensor data recevied via Sensor Abstraction Layer always has a timestamp associated with it. In particular:</p>
<ul>
<li>GMSL Cameras: timestamping is done by the kernel driver triggered by the hardware when full frame has been written into memory.</li>
<li>SocketCAN: timestamping occurs by the kernel driver when the full message is captured from the hardware by the driver. When hardware timestamping is used, timestamping is performed at the hardware level, by the TegraCAN hardware. The hardware counters are synced to the software clock.</li>
<li>AurixCAN: messages through this interface are timestamped by the Aurix safety OS. gPTP must be running and Aurix+Xavier clock must be synced to make CAN messages timestamped by Aurix be in sync with DriveWorks timestamps.</li>
<li>Serial port sensors (GPS): timestamping occurs when packets arrive to DriveWorks, at the software level.</li>
<li>Xsens IMU/GPS proprietary mode: clock of the Xsens devices are synchronized to DriveWorks clock, making timestamps to be in sync with DriveWorks timestamps.</li>
<li>Lidar: Lidar generated point clouds provide a DriveWorks timestamp (taken when the Ethernet packet was read), the sensor provided timestamp at start of capturing the packet, and the duration of the packet capture. If the particular sensor does not provide timestamps, both host and sensor timestamps are identical.</li>
</ul>
<p >Timestamps may be modified depending on the sensor parameter <code>output-timestamp</code>. This parameter supports four options as follows:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><code>output-timestamp=</code>   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>host</code>   </td><td class="markdownTableBodyNone">Default host time as described above.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>raw</code>   </td><td class="markdownTableBodyNone">If sensor provides timestamp embedded in payload, host time is overwritten with the raw sensor timestamp. This option also enables simulated sensors to supply an external timestamp.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>synced</code>   </td><td class="markdownTableBodyNone">If valid Time Sensor is active and sensor provides timestamp embedded in payload, perform SW time synchronization to convert to host domain. If successful, this timestamp is preferable as it is closer to time of data capture. If unsuccessful or vendor timestamps unavailable, DW will fallback to host time. This is the default option if parameter is not set.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>smoothed</code>   </td><td class="markdownTableBodyNone">If sensor supports time smoothing, apply on host timestamps. This option reduces jitter by averaging host/sensor timestamp deltas based on a predetermined window.   </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd>For a list of supported timestamp options per sensor, see:<ul>
<li><a class="el" href="gps_usecase3.html">Timestamp options</a></li>
<li><a class="el" href="imu_usecase3.html">Timestamp options</a></li>
<li><a class="el" href="lidar_usecase4.html">Timestamp options</a></li>
<li><a class="el" href="radar_usecase2.html">Timestamp options</a></li>
<li><a class="el" href="camera_usecase5.html">Timestamp options</a></li>
</ul>
</dd></dl>
<p>Output options are used in the following sample:</p><ul>
<li><a class="el" href="dwx_time_sensor_sample.html">Time Sensor Sample</a></li>
</ul>
<p >Sensor timestamping is used in multiple samples:</p><ul>
<li><a class="el" href="dwx_canbus_logger_sample.html">CAN Message Logger Sample</a> </li>
<li><a class="el" href="dwx_vehicleio_sample.html">VehicleIO Sample</a>  </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->

  <div id="nav-path" class="navpath">
    <ul>
      <li class="footer">
        Advance Information | Subject to Change |
        Prepared and Provided under NDA | Generated by NVIDIA |
        PR-08397-V5.0
      </li>
     </ul>
  </div>
</body>
</html>
