<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!--
 * Copyright (c) 2009-2014 NVIDIA CORPORATION.  All rights reserved.
 *
 * NVIDIA Corporation and its licensors retain all intellectual property
 * and proprietary rights in and to this software, related documentation
 * and any modifications thereto.  Any use, reproduction, disclosure or
 * distribution of this software and related documentation without an express
 * license agreement from NVIDIA Corporation is strictly prohibited.
-->
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<title>DriveWorks SDK Reference: Structure from Motion (SFM) Sample</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="Nvidia.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="reverb-search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="nv.css" rel="stylesheet" type="text/css" />
<link href="nvdwx.css" rel="stylesheet" type="text/css"/>
<style>
 body {
 background-position: 350px 150px;
 background-image: url(watermark.png);
 background-repeat: no-repeat;
 background-attachment: fixed;
 }
 </style>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table width="99%" border="0" cellspacing="1" cellpadding="1">
  <tbody>
    <tr valign="middle">
      <td rowspan="2" height="44" width="19%">
        <div>
            <a id="nv-logo" href="https://www.nvidia.com/"></a>
        </div>
      <td width="81%" height="44">
        <div style="text-align:right; font-weight: bold; font-size:20px"> <br/>DriveWorks SDK Reference </div>
        <div style="text-align:right">
        5.10.87 Release <br/> For Test and Development only <br/> <br/> </div>
    </td>
  </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('dwx_struct_from_motion_sample.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Structure from Motion (SFM) Sample </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#dwx_struct_from_motion_description">Description</a></li>
<li class="level1"><a href="#dwx_struct_from_motion_running">Running the Sample</a></li>
<li class="level1"><a href="#dwx_struct_from_motion_output">Output</a></li>
<li class="level1"><a href="#dwx_struct_from_motion_more">Additional Information</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="dwx_struct_from_motion_description"></a>
Description</h1>
<p >The Structure from Motion (SFM) sample demonstrates the triangulation functionality of the SFM module; a car pose is estimated entirely from CAN data using the NVIDIA<sup>&reg;</sup> DriveWorks egomotion module. The car has a 4-fisheye camera rig that is pre-calibrated. Features are detected and tracked using the features module. Points are triangulated for each frame by using the estimated pose and tracked features. Vehicle motion is parsed from CAN data using a custom VehicleIO plugin.</p>
<h1><a class="anchor" id="dwx_struct_from_motion_running"></a>
Running the Sample</h1>
<p >The structure from motion sample, sample_sfm, accepts the following optional parameters. If none are specified, it will process four supplied pre-recorded video. </p><pre class="fragment">./sample_sfm --baseDir=[path/to/rig/dir]
             --rig=[rig.json]
             --maxFeatureCount=[integer]
             --trackMode=[0|1]
             --useHalf=[0|1]
             --displacementThreshold=[fp_number]
             --enableAdaptiveWindowSize=[0|1]
</pre><p> where </p><pre class="fragment">--baseDir=[path/to/rig/dir]
    Path to the folder containint the rig.json file.
    Default value: path/to/data/samples/sfm/triangulation

--rig=[rig.json]
    A `rig.json` file as serialized by the DriveWorks rig module, or as produced by the DriveWorks calibration tool.
    The rig must include the 4 camera sensors and one CAN sensor.
    The rig sensors must contain valid protocol and parameter properties to open the virtual sensors.
    The video files must be a H.264 stream.
    Video containers as MP4, AVI, MKV, etc. are not supported.
    The rig file also points to a video timestamps text file where each row contains the frame index
    (starting at 1) and the timestamp for all cameras. It is read by the camera virtual sensor.
    The rig file must contain a valid VehicleIO driver.
    Default value: rig.json

--maxFeatureCount=[integer]
    The manixum amount of features stored for tracking.
    Default value: 2000

--trackMode=[0|1]
    Defines feature tracking mode.
    0: translation-only KLT tracker or Sparse LK PVA tracker
    1: translation-scale fast KLT tracker
    Default value: 0

--useHalf=[0|1]
    Defines whether to use fp16 for tracking.
    --useHalf=0 uses fp32 for tracking.
    --useHalf=1 uses fp16 for tracking.
    This parameter only takes effect when --trackMode=1.
    Default value: 0

--displacementThreshold=[fp_number]
    Defines the early stop threshold during translation-only tracking.
    This parameter only takes effect when --trackMode=1.
    Default value: 0.1

--enableAdaptiveWindowSize=[0|1]
    Defines whether to use full window size at the lowest and the highest levels,
    and smaller window size at the rest of levels during tracking.
    This parameter only takes effect when --trackMode=1.
    Default value: 1
</pre><p> If a mouse is available, the left button rotates the 3D view, the right button translate, and the mouse wheel zooms.</p>
<p >While the sample is running the following commands are available:</p><ul>
<li>Press V to enable / disable pose estimation.</li>
<li>Press F to enable / disable feature position prediction.</li>
<li>Press Space to pause / resume execution.</li>
<li>Press Q to switch between different camera views.</li>
<li>Press R to restart playback.</li>
</ul>
<h1><a class="anchor" id="dwx_struct_from_motion_output"></a>
Output</h1>
<p >The left side of the screen shows the 4 input images; tracked features are shown in green. Triangulated points are reprojected back onto the camera and shown in red. The right side shows a 3D view of the triangulated point cloud.</p>
<p >In 3D, the colors are:</p>
<ul>
<li>Red points = points from frontal camera</li>
<li>Green points = points from rear camera</li>
<li>Blue points = points from left camera</li>
<li>Yellow points = points from right camera</li>
<li>Green/red line = path of the car</li>
</ul>
<div class="image">
<img src="sample_triangulation.png" alt=""/>
<div class="caption">
Structure from Motion sample</div></div>
    <h1><a class="anchor" id="dwx_struct_from_motion_more"></a>
Additional Information</h1>
<p >For more details see <a class="el" href="sfm_mainsection.html">Structure from Motion (SFM)</a> . </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->

  <div id="nav-path" class="navpath">
    <ul>
      <li class="footer">
        Advance Information | Subject to Change |
        Prepared and Provided under NDA | Generated by NVIDIA |
        PR-08397-V5.0
      </li>
     </ul>
  </div>
</body>
</html>
