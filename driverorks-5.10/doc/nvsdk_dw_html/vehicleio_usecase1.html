<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!--
 * Copyright (c) 2009-2014 NVIDIA CORPORATION.  All rights reserved.
 *
 * NVIDIA Corporation and its licensors retain all intellectual property
 * and proprietary rights in and to this software, related documentation
 * and any modifications thereto.  Any use, reproduction, disclosure or
 * distribution of this software and related documentation without an express
 * license agreement from NVIDIA Corporation is strictly prohibited.
-->
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<title>DriveWorks SDK Reference: VehicleIO Workflow</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="Nvidia.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="reverb-search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="nv.css" rel="stylesheet" type="text/css" />
<link href="nvdwx.css" rel="stylesheet" type="text/css"/>
<style>
 body {
 background-position: 350px 150px;
 background-image: url(watermark.png);
 background-repeat: no-repeat;
 background-attachment: fixed;
 }
 </style>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table width="99%" border="0" cellspacing="1" cellpadding="1">
  <tbody>
    <tr valign="middle">
      <td rowspan="2" height="44" width="19%">
        <div>
            <a id="nv-logo" href="https://www.nvidia.com/"></a>
        </div>
      <td width="81%" height="44">
        <div style="text-align:right; font-weight: bold; font-size:20px"> <br/>DriveWorks SDK Reference </div>
        <div style="text-align:right">
        5.10.87 Release <br/> For Test and Development only <br/> <br/> </div>
    </td>
  </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('vehicleio_usecase1.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">VehicleIO Workflow </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h3>Initialization</h3>
<p >The <code><a class="el" href="group__VehicleIO__actuators__group.html#ga0ed33a25a05282546ba87f9baec5dcc9" title="Initialize VehicleIO and prepare all internal structures.">dwVehicleIO_initialize()</a></code> function creates a VehicleIO instance. That functions takes the following parameters:</p>
<ul>
<li>VehicleIO handle: <code><a class="el" href="group__VehicleIO__actuators__group.html#gabccf4f09e383ac30ae84d37167b9f1ef">dwVehicleIOHandle_t</a></code></li>
<li>Type of interface device: <code><a class="el" href="group__VehicleIO__actuators__group.html#gae30d2ac2d5f5fb8ee4a62ee42691bf1a">dwVehicleIOType</a></code> (<a class="el" href="group__VehicleIO__actuators__group.html#ggae30d2ac2d5f5fb8ee4a62ee42691bf1aa23e50b9b9b930ebd10a54d15f2c07f85">DW_VEHICLEIO_DATASPEED</a> / <a class="el" href="group__VehicleIO__actuators__group.html#ggae30d2ac2d5f5fb8ee4a62ee42691bf1aa201f2c0cd49f317f0fa6e501202d0b29">DW_VEHICLEIO_GENERIC</a> / <a class="el" href="group__VehicleIO__actuators__group.html#ggae30d2ac2d5f5fb8ee4a62ee42691bf1aad6cfd0b1f18af59b6674105e4f4f105a">DW_VEHICLEIO_CUSTOM</a>)</li>
<li>Handle to the vehicle: <code><a class="el" href="group__rig__configuration__group.html#structdwVehicle" title="DEPRECATED: Properties of a passenger car vehicle.">dwVehicle</a></code></li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Before creating a VehicleIO instance, you must initialize the rig configuration module using <code><a class="el" href="group__rig__configuration__group.html#gaba5ac271d4af54f1deece15ac3376bba" title="Initializes the Rig Configuration module from a file.">dwRig_initializeFromFile()</a></code> and then get the vehicle properties using <code><a class="el" href="group__rig__configuration__group.html#ga9c19fc13a774f2b4e6ddb0b6e458157b" title="DEPRECATED: Gets the properties of a passenger car vehicle.">dwRig_getVehicle()</a></code>. For more information, see Rig Configuration in this guide.</dd></dl>
<ul>
<li>Context Handle : <code><a class="el" href="group__timer__group.html#gae81934046206143539721bbe30b08a1e">dwContextHandle_t</a></code></li>
</ul>
<h3>Driving Mode</h3>
<p >The <code><a class="el" href="group__VehicleIO__actuators__group.html#ga9361719c9a677d7176f6b448f98238fb" title="Setting driving mode allows to control the behaviour of VehicleIO module with regards to the permitte...">dwVehicleIO_setDrivingMode()</a></code> function sets the driving mode. This function consumes the <a class="el" href="group__VehicleIO__actuators__group.html#gaf03eb7ed957c0492001a45b061a30018">dwVehicleIODrivingMode()</a> enum as an argument, which is defined as </p><div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code hl_enumeration" href="group__VehicleIO__actuators__group.html#gaf03eb7ed957c0492001a45b061a30018">dwVehicleIODrivingMode</a></div>
<div class="line">{</div>
<div class="line">    <a class="code hl_enumvalue" href="group__VehicleIO__actuators__group.html#ggaf03eb7ed957c0492001a45b061a30018a32089886e8b78911f3b5dd89f7b94cc0">DW_VEHICLEIO_DRIVING_LIMITED</a> = 0x000,</div>
<div class="line">    <a class="code hl_enumvalue" href="group__VehicleIO__actuators__group.html#ggaf03eb7ed957c0492001a45b061a30018aa8069331c98dd585c487d5908c51757d">DW_VEHICLEIO_DRIVING_LIMITED_ND</a> = 0x100,</div>
<div class="line">    <a class="code hl_enumvalue" href="group__VehicleIO__actuators__group.html#ggaf03eb7ed957c0492001a45b061a30018a8fcc056461e8db890aecb1c612e9ea62">DW_VEHICLEIO_DRIVING_COLLISION_AVOIDANCE</a> = 0x200,</div>
<div class="line">    <a class="code hl_enumvalue" href="group__VehicleIO__actuators__group.html#ggaf03eb7ed957c0492001a45b061a30018a4ca865201d548923a26e170e08b52922">DW_VEHICLEIO_DRIVING_NO_SAFETY</a> = 0x300</div>
<div class="line">} <a class="code hl_enumeration" href="group__VehicleIO__actuators__group.html#gaf03eb7ed957c0492001a45b061a30018">dwVehicleIODrivingMode</a>; </div>
<div class="ttc" id="agroup__VehicleIO__actuators__group_html_gaf03eb7ed957c0492001a45b061a30018"><div class="ttname"><a href="group__VehicleIO__actuators__group.html#gaf03eb7ed957c0492001a45b061a30018">dwVehicleIODrivingMode</a></div><div class="ttdeci">dwVehicleIODrivingMode</div><div class="ttdef"><b>Definition:</b> <a href="VehicleIOLegacyStructures_8h_source.html#l00060">VehicleIOLegacyStructures.h:60</a></div></div>
<div class="ttc" id="agroup__VehicleIO__actuators__group_html_ggaf03eb7ed957c0492001a45b061a30018a32089886e8b78911f3b5dd89f7b94cc0"><div class="ttname"><a href="group__VehicleIO__actuators__group.html#ggaf03eb7ed957c0492001a45b061a30018a32089886e8b78911f3b5dd89f7b94cc0">DW_VEHICLEIO_DRIVING_LIMITED</a></div><div class="ttdeci">@ DW_VEHICLEIO_DRIVING_LIMITED</div><div class="ttdoc">Comfortable driving is expected (most conservative).</div><div class="ttdef"><b>Definition:</b> <a href="VehicleIOLegacyStructures_8h_source.html#l00064">VehicleIOLegacyStructures.h:64</a></div></div>
<div class="ttc" id="agroup__VehicleIO__actuators__group_html_ggaf03eb7ed957c0492001a45b061a30018a4ca865201d548923a26e170e08b52922"><div class="ttname"><a href="group__VehicleIO__actuators__group.html#ggaf03eb7ed957c0492001a45b061a30018a4ca865201d548923a26e170e08b52922">DW_VEHICLEIO_DRIVING_NO_SAFETY</a></div><div class="ttdeci">@ DW_VEHICLEIO_DRIVING_NO_SAFETY</div><div class="ttdoc">VehicleIO will bypass all safety checks.</div><div class="ttdef"><b>Definition:</b> <a href="VehicleIOLegacyStructures_8h_source.html#l00075">VehicleIOLegacyStructures.h:75</a></div></div>
<div class="ttc" id="agroup__VehicleIO__actuators__group_html_ggaf03eb7ed957c0492001a45b061a30018a8fcc056461e8db890aecb1c612e9ea62"><div class="ttname"><a href="group__VehicleIO__actuators__group.html#ggaf03eb7ed957c0492001a45b061a30018a8fcc056461e8db890aecb1c612e9ea62">DW_VEHICLEIO_DRIVING_COLLISION_AVOIDANCE</a></div><div class="ttdeci">@ DW_VEHICLEIO_DRIVING_COLLISION_AVOIDANCE</div><div class="ttdoc">Safety checks suitable for collision avoidance logic (right now same as NO_SAFETY below).</div><div class="ttdef"><b>Definition:</b> <a href="VehicleIOLegacyStructures_8h_source.html#l00072">VehicleIOLegacyStructures.h:72</a></div></div>
<div class="ttc" id="agroup__VehicleIO__actuators__group_html_ggaf03eb7ed957c0492001a45b061a30018aa8069331c98dd585c487d5908c51757d"><div class="ttname"><a href="group__VehicleIO__actuators__group.html#ggaf03eb7ed957c0492001a45b061a30018aa8069331c98dd585c487d5908c51757d">DW_VEHICLEIO_DRIVING_LIMITED_ND</a></div><div class="ttdeci">@ DW_VEHICLEIO_DRIVING_LIMITED_ND</div><div class="ttdoc">Same as above, but unsafe commands are clamped to safe limits and warnings are isssued.</div><div class="ttdef"><b>Definition:</b> <a href="VehicleIOLegacyStructures_8h_source.html#l00068">VehicleIOLegacyStructures.h:68</a></div></div>
</div><!-- fragment --> <h3>Vehicle State Information</h3>
<p >The <code><a class="el" href="group__VehicleIO__actuators__group.html#gadb4a97bea2caeb409b783d5e6d62d938" title="Parse a received event.">dwVehicleIO_consumeCANFrame()</a></code> function parses received CAN messages. The resulting parsed messages generate certain reports, which can be gathered using the predefined callbacks.</p>
<p >The current vehicle state information can be retrieved with <code><a class="el" href="group__VehicleIO__actuators__group.html#gad3986559acedfe54939c3729261bd46b" title="Retrieve current vehicle safety state.">dwVehicleIO_getVehicleSafetyState()</a></code>, <code><a class="el" href="group__VehicleIO__actuators__group.html#ga64226a58a43467a8c469b4e2fa2e33d9" title="Retrieve current vehicle non-safety state.">dwVehicleIO_getVehicleNonSafetyState()</a></code>, and <code>dwVehicleIO_getVehicleActuationFeedback</code>, which return the vehicle state in the <code><a class="el" href="group__VehicleIO__actuators__group.html#structdwVehicleIOSafetyState" title="Safety critical VIO state.">dwVehicleIOSafetyState</a></code>, <code><a class="el" href="group__VehicleIO__actuators__group.html#structdwVehicleIONonSafetyState" title="Non-safety critical RoV state.">dwVehicleIONonSafetyState</a></code>, and <code><a class="el" href="group__VehicleIO__actuators__group.html#structdwVehicleIOActuationFeedback" title="Feedback from actuation.">dwVehicleIOActuationFeedback</a></code> formats respectively.</p>
<h3>Sending Vehicle Commands</h3>
<p >The <code>dwVehicleIO_sendVehicleCommand()</code> function sends a command to the vehicle via VehicleIO. The command is sent in the <code><a class="el" href="group__VehicleIO__actuators__group.html#structdwVehicleIOCommand" title="The command data.">dwVehicleIOCommand</a></code> format and is passed as one of the arguments. An additional argument is passed as a handle to the underlying sensor that VehicleIO uses to pass this command.</p>
<h3>Selecting Driver Overrides</h3>
<p >Signals that the driver uses to override Vehicle control are configurable and can be selected using <code><a class="el" href="group__VehicleIO__actuators__group.html#gacd710e7648b88151a556120d9744c252" title="Select the overrides that the driver can use to disable vehicle control.">dwVehicleIO_selectDriverOverrides()</a></code>. The driver can override vehicle control with any combination of throttle, steering, brake, and/or gear.</p>
<h1>Conditions for Engagement and Disengagement</h1>
<p >In order to enable vehicle actuation (i.e. engage), several conditions must be satisfied:</p>
<ul>
<li><code><a class="el" href="group__VehicleIO__actuators__group.html#a761dde1f4f44455971cc166f4cb98b19" title="True if we are driving by wire. Has to always be set.">dwVehicleIOCommand::enable</a></code> must be set to <code>true</code>.</li>
<li>Desired <code><a class="el" href="group__VehicleIO__actuators__group.html#structdwVehicleIOCommand" title="The command data.">dwVehicleIOCommand</a>::*Valid</code> flags must be set to <code>true</code>, for example <code><a class="el" href="group__VehicleIO__actuators__group.html#ae81c2acc43f0d867ac6d7a0431d56fc4" title="True if setting break.">dwVehicleIOCommand::brakeValid</a></code> to actuate vehicle braking.</li>
<li>All bits in <code><a class="el" href="group__VehicleIO__actuators__group.html#a83eb54ccaee84fb63f39ed9e0a23ecd4" title="Faults detected (0 = none). Flags defined in dwVehicleIOFaults.">dwVehicleIOState::faults</a></code> must be clear. Recoverable faults can be cleared by sending a command with <code><a class="el" href="group__VehicleIO__actuators__group.html#ac4f0afff4ba4548ceb895d2cf1f3c6ae" title="Setting &gt; 0 clears any canbus faults/errors.">dwVehicleIOCommand::clearFaults</a></code> set to <code>true</code>.</li>
<li><code><a class="el" href="group__VehicleIO__actuators__group.html#a13e8a9baba8aa23015e9c16a53afa5e2" title="Overrides in place (0 = none). Flags defined in dwVehicleIOOverrides.">dwVehicleIOState::overrides</a></code> must be clear for all enabled driver overrides. To clear <code><a class="el" href="group__VehicleIO__actuators__group.html#a13e8a9baba8aa23015e9c16a53afa5e2" title="Overrides in place (0 = none). Flags defined in dwVehicleIOOverrides.">dwVehicleIOState::overrides</a></code>, one has to send a command with <code><a class="el" href="group__VehicleIO__actuators__group.html#ac4f0afff4ba4548ceb895d2cf1f3c6ae" title="Setting &gt; 0 clears any canbus faults/errors.">dwVehicleIOCommand::clearFaults</a></code> set to <code>true</code> (same field is used to clear faults and overrides).</li>
</ul>
<p >Once engaged, both Drive-By-Wire hardware and/or VehicleIO might decide to disable vehicle actuation (i.e. disengage), there are a few cases when this might happen:</p>
<ul>
<li>Application-requested disengagement: <code><a class="el" href="group__VehicleIO__actuators__group.html#a761dde1f4f44455971cc166f4cb98b19" title="True if we are driving by wire. Has to always be set.">dwVehicleIOCommand::enable</a></code> is set to <code>false</code>.</li>
<li>Disengagement due to Drive-By-Wire faults. Which hardware actuation unit caused the disengagement will be indicated via <code><a class="el" href="group__VehicleIO__actuators__group.html#a83eb54ccaee84fb63f39ed9e0a23ecd4" title="Faults detected (0 = none). Flags defined in dwVehicleIOFaults.">dwVehicleIOState::faults</a></code> (see corresponding <code><a class="el" href="group__VehicleIO__actuators__group.html#ga0fc68eb19e490c4477f34b2bdb8cd5d1">dwVehicleIOFaults</a></code> enumeration). Exact reason for disengagement can be traced back using CAN logs and Drive-By-Wire vendor documentation.</li>
<li>Disengagement due to driver overrides as detected by Drive-By-Wire hardware. Exact reason will be indicated via corresponding bits in <code><a class="el" href="group__VehicleIO__actuators__group.html#a13e8a9baba8aa23015e9c16a53afa5e2" title="Overrides in place (0 = none). Flags defined in dwVehicleIOOverrides.">dwVehicleIOState::overrides</a></code> (see corresponding <code><a class="el" href="group__VehicleIO__actuators__group.html#ga7cebca9a6c24ef02e6fb02921597530d">dwVehicleIOOverrides</a></code> enumeration).</li>
<li>If VehicleIO is in <code><a class="el" href="group__VehicleIO__actuators__group.html#ggaf03eb7ed957c0492001a45b061a30018a32089886e8b78911f3b5dd89f7b94cc0" title="Comfortable driving is expected (most conservative).">DW_VEHICLEIO_DRIVING_LIMITED</a></code> mode, some commands (such as braking) that are considered not appropriate for limited actuation will cause VehicleIO to stop sending commands to the vehicle (i.e. VehicleIO will disengage). In this case, <code><a class="el" href="group__VehicleIO__actuators__group.html#gga0fc68eb19e490c4477f34b2bdb8cd5d1abe8bc73dff9a8776627429ce6fd54872">DW_VEHICLEIO_FAULT_SAFETY</a></code> bit will set in <code><a class="el" href="group__VehicleIO__actuators__group.html#a83eb54ccaee84fb63f39ed9e0a23ecd4" title="Faults detected (0 = none). Flags defined in dwVehicleIOFaults.">dwVehicleIOState::faults</a></code>.</li>
<li>If VehicleIO stopped receiving Drive-By-Wire reports for more than 100 milliseconds and VehicleIO is in <code><a class="el" href="group__VehicleIO__actuators__group.html#ggaf03eb7ed957c0492001a45b061a30018a32089886e8b78911f3b5dd89f7b94cc0" title="Comfortable driving is expected (most conservative).">DW_VEHICLEIO_DRIVING_LIMITED</a></code> mode, then <code><a class="el" href="group__VehicleIO__actuators__group.html#gga0fc68eb19e490c4477f34b2bdb8cd5d1abe8bc73dff9a8776627429ce6fd54872">DW_VEHICLEIO_FAULT_SAFETY</a></code> bit will set in <code><a class="el" href="group__VehicleIO__actuators__group.html#a83eb54ccaee84fb63f39ed9e0a23ecd4" title="Faults detected (0 = none). Flags defined in dwVehicleIOFaults.">dwVehicleIOState::faults</a></code> and VehicleIO will disengage.</li>
</ul>
<h3>VehicleIO Sample</h3>
<p >See <a class="el" href="dwx_vehicleio_sample.html">VehicleIO Sample</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->

  <div id="nav-path" class="navpath">
    <ul>
      <li class="footer">
        Advance Information | Subject to Change |
        Prepared and Provided under NDA | Generated by NVIDIA |
        PR-08397-V5.0
      </li>
     </ul>
  </div>
</body>
</html>
