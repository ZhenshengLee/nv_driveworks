<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!--
 * Copyright (c) 2009-2014 NVIDIA CORPORATION.  All rights reserved.
 *
 * NVIDIA Corporation and its licensors retain all intellectual property
 * and proprietary rights in and to this software, related documentation
 * and any modifications thereto.  Any use, reproduction, disclosure or
 * distribution of this software and related documentation without an express
 * license agreement from NVIDIA Corporation is strictly prohibited.
-->
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<title>DriveWorks SDK Reference: Global Egomotion Workflow</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="Nvidia.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="reverb-search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="nv.css" rel="stylesheet" type="text/css" />
<link href="nvdwx.css" rel="stylesheet" type="text/css"/>
<style>
 body {
 background-position: 350px 150px;
 background-image: url(watermark.png);
 background-repeat: no-repeat;
 background-attachment: fixed;
 }
 </style>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table width="99%" border="0" cellspacing="1" cellpadding="1">
  <tbody>
    <tr valign="middle">
      <td rowspan="2" height="44" width="19%">
        <div>
            <a id="nv-logo" href="https://www.nvidia.com/"></a>
        </div>
      <td width="81%" height="44">
        <div style="text-align:right; font-weight: bold; font-size:20px"> <br/>DriveWorks SDK Reference </div>
        <div style="text-align:right">
        5.10.87 Release <br/> For Test and Development only <br/> <br/> </div>
    </td>
  </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('egomotion_usecase2.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Global Egomotion Workflow </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Workflow</h1>
<h2>Initialization</h2>
<p >To initialize the global egomotion module, certain configuration parameters can be set, for example the position of the GNSS antenna in the rig coordinate system. Other parameters include noise and drift characteristics, or the size of the internal history storing state estimates. A typical initialization code sequence will look like this:</p>
<div class="fragment"><div class="line"><span class="comment">// read vehicle configuration</span></div>
<div class="line"><a class="code hl_typedef" href="group__rig__configuration__group.html#ga69108a61f90f528053d6344ac49073f1">dwRigHandle_t</a> rig;</div>
<div class="line"><a class="code hl_function" href="group__rig__configuration__group.html#gaba5ac271d4af54f1deece15ac3376bba">dwRig_initializeFromFile</a>(&amp;rig, sdkContext, <span class="stringliteral">&quot;path/to/rig.json&quot;</span>);</div>
<div class="line">    </div>
<div class="line"><span class="comment">// initialize global egomotion parameters</span></div>
<div class="line"><a class="code hl_struct" href="group__global__egomotion__group.html#structdwGlobalEgomotionParameters">dwGlobalEgomotionParameters</a> params{};</div>
<div class="line"><a class="code hl_function" href="group__global__egomotion__group.html#ga51ef486a35ba3fc6c39541086f6c5471">dwGlobalEgomotion_initParamsFromRig</a>(&amp;params, rig, <span class="stringliteral">&quot;gps_sensor_name&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// other parameters left 0-initialized will be ignored and default values used instead</span></div>
<div class="line"><span class="comment">// see API documentation</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// initialize global egomotion module</span></div>
<div class="line"><a class="code hl_function" href="group__global__egomotion__group.html#gab208874d07cc6b978a08b946850482dd">dwGlobalEgomotion_initialize</a>(&amp;globalEgomotion, &amp;params, sdkContext);    </div>
<div class="ttc" id="agroup__global__egomotion__group_html_ga51ef486a35ba3fc6c39541086f6c5471"><div class="ttname"><a href="group__global__egomotion__group.html#ga51ef486a35ba3fc6c39541086f6c5471">dwGlobalEgomotion_initParamsFromRig</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwGlobalEgomotion_initParamsFromRig(dwGlobalEgomotionParameters *params, dwConstRigHandle_t rigConfiguration, const char *gpsSensorName)</div><div class="ttdoc">Initialize global egomotion parameters from a provided RigConfiguration.</div></div>
<div class="ttc" id="agroup__global__egomotion__group_html_gab208874d07cc6b978a08b946850482dd"><div class="ttname"><a href="group__global__egomotion__group.html#gab208874d07cc6b978a08b946850482dd">dwGlobalEgomotion_initialize</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwGlobalEgomotion_initialize(dwGlobalEgomotionHandle_t *handle, const dwGlobalEgomotionParameters *params, dwContextHandle_t ctx)</div><div class="ttdoc">Initializes the global egomotion module.</div></div>
<div class="ttc" id="agroup__global__egomotion__group_html_structdwGlobalEgomotionParameters"><div class="ttname"><a href="group__global__egomotion__group.html#structdwGlobalEgomotionParameters">dwGlobalEgomotionParameters</a></div><div class="ttdoc">Holds initialization parameters for the global egomotion module.</div><div class="ttdef"><b>Definition:</b> <a href="GlobalEgomotion_8h_source.html#l00082">GlobalEgomotion.h:83</a></div></div>
<div class="ttc" id="agroup__rig__configuration__group_html_ga69108a61f90f528053d6344ac49073f1"><div class="ttname"><a href="group__rig__configuration__group.html#ga69108a61f90f528053d6344ac49073f1">dwRigHandle_t</a></div><div class="ttdeci">struct dwRigObject * dwRigHandle_t</div><div class="ttdoc">Handle representing the Rig interface.</div><div class="ttdef"><b>Definition:</b> <a href="Rig_8h_source.html#l00070">Rig.h:70</a></div></div>
<div class="ttc" id="agroup__rig__configuration__group_html_gaba5ac271d4af54f1deece15ac3376bba"><div class="ttname"><a href="group__rig__configuration__group.html#gaba5ac271d4af54f1deece15ac3376bba">dwRig_initializeFromFile</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwRig_initializeFromFile(dwRigHandle_t *const obj, dwContextHandle_t const ctx, char8_t const *const configurationFile)</div><div class="ttdoc">Initializes the Rig Configuration module from a file.</div></div>
</div><!-- fragment --><h2>Run-time filter update and global position and orientation estimation</h2>
<p >At run-time the global egomotion filter has to be filled with measurements from the GNSS sensor, as well as motion estimates from a relative egomotion module. The following example assumes that such a relative egomotion module with handle <code>relativeEgomotion</code> has been initialized and is being updated elsewhere; see <a class="el" href="egomotion_usecase1.html">Relative Egomotion Workflow</a> for more details.</p>
<div class="fragment"><div class="line"><span class="keywordflow">while</span>(<span class="keyword">true</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// read GPS measurements</span></div>
<div class="line">    <span class="keywordflow">if</span> (hasGPSMeasurement())</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_function" href="group__global__egomotion__group.html#ga137dec1b1147646576c355278d7647ef">dwGlobalEgomotion_addGPSMeasurement</a>(getGPSMeasurement(), globalEgomotion);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ...</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// update global egomotion module with latest relative egomotion estimates</span></div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_struct" href="group__egomotion__group.html#structdwEgomotionResult">dwEgomotionResult</a> state;</div>
<div class="line">        <a class="code hl_struct" href="group__egomotion__group.html#structdwEgomotionUncertainty">dwEgomotionUncertainty</a> uncertainty;</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_function" href="group__egomotion__group.html#ga16ef31c1d0ba70f55aa448908c708924">dwEgomotion_getEstimation</a>(&amp;state, relativeEgomotion) == DW_SUCCESS &amp;&amp;</div>
<div class="line">            <a class="code hl_function" href="group__egomotion__group.html#ga27544beaf8341c07cabe8ea6288c1ee1">dwEgomotion_getUncertainty</a>(&amp;uncertainty, relativeEgomotion) == DW_SUCCESS)</div>
<div class="line">            {</div>
<div class="line">                <a class="code hl_function" href="group__global__egomotion__group.html#ga438404e7dfdb2aa89435d5b82bc86aed">dwGlobalEgomotion_addRelativeMotion</a>(&amp;state, &amp;uncertainty, globalEgomotion);</div>
<div class="line">            }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ...</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// get latest global state estimate</span></div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_struct" href="group__global__egomotion__group.html#structdwGlobalEgomotionResult">dwGlobalEgomotionResult</a> result;</div>
<div class="line">        <a class="code hl_struct" href="group__global__egomotion__group.html#structdwGlobalEgomotionUncertainty">dwGlobalEgomotionUncertainty</a> uncertainty;</div>
<div class="line">        <a class="code hl_function" href="group__global__egomotion__group.html#ga10ad331dfb9c7d355294b95325a70c6d">dwGlobalEgomotion_getEstimate</a>(&amp;result, &amp;uncertainty, globalEgomotion);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// position estimate in WGS-84 as well as orientation relative to ENU coordinate system</span></div>
<div class="line">        <span class="comment">// can now be accessed.</span></div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    ...</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// interpolate global state estimate to specific timestamp</span></div>
<div class="line">    <span class="comment">// extrapolation is supported but limited to a short time interval, see API doc.</span></div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_typedef" href="group__core__basictypes__group.html#gac4840df46df4be80c7f427057740af65">dwTime_t</a> requestedTimestamp = ...;</div>
<div class="line">        <a class="code hl_struct" href="group__global__egomotion__group.html#structdwGlobalEgomotionResult">dwGlobalEgomotionResult</a> result;</div>
<div class="line">        <a class="code hl_struct" href="group__global__egomotion__group.html#structdwGlobalEgomotionUncertainty">dwGlobalEgomotionUncertainty</a> uncertainty;</div>
<div class="line">        </div>
<div class="line">        <a class="code hl_function" href="group__global__egomotion__group.html#gabb5fd8a998581734480f47f8736783ed">dwGlobalEgomotion_computeEstimate</a>(&amp;result, &amp;uncertainty, requestedTimestamp, globalEgomotion);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// position estimate in WGS-84 as well as orientation relative to ENU coordinate system</span></div>
<div class="line">        <span class="comment">// at `requestedTimestamp` can now be accessed.</span></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__core__basictypes__group_html_gac4840df46df4be80c7f427057740af65"><div class="ttname"><a href="group__core__basictypes__group.html#gac4840df46df4be80c7f427057740af65">dwTime_t</a></div><div class="ttdeci">int64_t dwTime_t</div><div class="ttdoc">Specifies a timestamp unit, in microseconds.</div><div class="ttdef"><b>Definition:</b> <a href="BasicTypes_8h_source.html#l00063">BasicTypes.h:63</a></div></div>
<div class="ttc" id="agroup__egomotion__group_html_ga16ef31c1d0ba70f55aa448908c708924"><div class="ttname"><a href="group__egomotion__group.html#ga16ef31c1d0ba70f55aa448908c708924">dwEgomotion_getEstimation</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwEgomotion_getEstimation(dwEgomotionResult *result, dwEgomotionConstHandle_t obj)</div><div class="ttdoc">Gets the latest state estimate.</div></div>
<div class="ttc" id="agroup__egomotion__group_html_ga27544beaf8341c07cabe8ea6288c1ee1"><div class="ttname"><a href="group__egomotion__group.html#ga27544beaf8341c07cabe8ea6288c1ee1">dwEgomotion_getUncertainty</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwEgomotion_getUncertainty(dwEgomotionUncertainty *result, dwEgomotionConstHandle_t obj)</div><div class="ttdoc">Gets the latest state estimate uncertainties.</div></div>
<div class="ttc" id="agroup__egomotion__group_html_structdwEgomotionResult"><div class="ttname"><a href="group__egomotion__group.html#structdwEgomotionResult">dwEgomotionResult</a></div><div class="ttdoc">Holds egomotion state estimate.</div><div class="ttdef"><b>Definition:</b> <a href="Egomotion_8h_source.html#l00446">Egomotion.h:447</a></div></div>
<div class="ttc" id="agroup__egomotion__group_html_structdwEgomotionUncertainty"><div class="ttname"><a href="group__egomotion__group.html#structdwEgomotionUncertainty">dwEgomotionUncertainty</a></div><div class="ttdoc">Holds egomotion uncertainty estimates.</div><div class="ttdef"><b>Definition:</b> <a href="Egomotion_8h_source.html#l00480">Egomotion.h:481</a></div></div>
<div class="ttc" id="agroup__global__egomotion__group_html_ga10ad331dfb9c7d355294b95325a70c6d"><div class="ttname"><a href="group__global__egomotion__group.html#ga10ad331dfb9c7d355294b95325a70c6d">dwGlobalEgomotion_getEstimate</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwGlobalEgomotion_getEstimate(dwGlobalEgomotionResult *result, dwGlobalEgomotionUncertainty *uncertainty, dwGlobalEgomotionConstHandle_t handle)</div><div class="ttdoc">Get current filter state estimate.</div></div>
<div class="ttc" id="agroup__global__egomotion__group_html_ga137dec1b1147646576c355278d7647ef"><div class="ttname"><a href="group__global__egomotion__group.html#ga137dec1b1147646576c355278d7647ef">dwGlobalEgomotion_addGPSMeasurement</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwGlobalEgomotion_addGPSMeasurement(const dwGPSFrame *measurement, dwGlobalEgomotionHandle_t handle)</div><div class="ttdoc">Adds GPS measurement to the global egomotion module.</div></div>
<div class="ttc" id="agroup__global__egomotion__group_html_ga438404e7dfdb2aa89435d5b82bc86aed"><div class="ttname"><a href="group__global__egomotion__group.html#ga438404e7dfdb2aa89435d5b82bc86aed">dwGlobalEgomotion_addRelativeMotion</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwGlobalEgomotion_addRelativeMotion(const dwEgomotionResult *egomotionResult, const dwEgomotionUncertainty *egomotionUncertainty, dwGlobalEgomotionHandle_t handle)</div><div class="ttdoc">Adds relative egomotion estimate to the global egomotion module.</div></div>
<div class="ttc" id="agroup__global__egomotion__group_html_gabb5fd8a998581734480f47f8736783ed"><div class="ttname"><a href="group__global__egomotion__group.html#gabb5fd8a998581734480f47f8736783ed">dwGlobalEgomotion_computeEstimate</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwGlobalEgomotion_computeEstimate(dwGlobalEgomotionResult *result, dwGlobalEgomotionUncertainty *uncertainty, dwTime_t timestamp, dwGlobalEgomotionConstHandle_t handle)</div><div class="ttdoc">Computes global state estimate at given timestamp, if necessary by linear interpolation between avail...</div></div>
<div class="ttc" id="agroup__global__egomotion__group_html_structdwGlobalEgomotionResult"><div class="ttname"><a href="group__global__egomotion__group.html#structdwGlobalEgomotionResult">dwGlobalEgomotionResult</a></div><div class="ttdoc">Holds global egomotion state estimate.</div><div class="ttdef"><b>Definition:</b> <a href="GlobalEgomotion_8h_source.html#l00101">GlobalEgomotion.h:102</a></div></div>
<div class="ttc" id="agroup__global__egomotion__group_html_structdwGlobalEgomotionUncertainty"><div class="ttname"><a href="group__global__egomotion__group.html#structdwGlobalEgomotionUncertainty">dwGlobalEgomotionUncertainty</a></div><div class="ttdoc">Holds global egomotion uncertainty estimate.</div><div class="ttdef"><b>Definition:</b> <a href="GlobalEgomotion_8h_source.html#l00116">GlobalEgomotion.h:117</a></div></div>
</div><!-- fragment --><p >Before using any state estimates, always verify their validity by inspecting the return codes of the various APIs as well as the flags contained within the state and uncertainty structures.</p>
<p >This workflow is demonstrated in the following sample: <a class="el" href="dwx_egomotion_sample.html">Egomotion Sample</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->

  <div id="nav-path" class="navpath">
    <ul>
      <li class="footer">
        Advance Information | Subject to Change |
        Prepared and Provided under NDA | Generated by NVIDIA |
        PR-08397-V5.0
      </li>
     </ul>
  </div>
</body>
</html>
