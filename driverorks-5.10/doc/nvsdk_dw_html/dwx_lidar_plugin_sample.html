<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!--
 * Copyright (c) 2009-2014 NVIDIA CORPORATION.  All rights reserved.
 *
 * NVIDIA Corporation and its licensors retain all intellectual property
 * and proprietary rights in and to this software, related documentation
 * and any modifications thereto.  Any use, reproduction, disclosure or
 * distribution of this software and related documentation without an express
 * license agreement from NVIDIA Corporation is strictly prohibited.
-->
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<title>DriveWorks SDK Reference: Lidar Plugin Sample</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="Nvidia.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="reverb-search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="nv.css" rel="stylesheet" type="text/css" />
<link href="nvdwx.css" rel="stylesheet" type="text/css"/>
<style>
 body {
 background-position: 350px 150px;
 background-image: url(watermark.png);
 background-repeat: no-repeat;
 background-attachment: fixed;
 }
 </style>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table width="99%" border="0" cellspacing="1" cellpadding="1">
  <tbody>
    <tr valign="middle">
      <td rowspan="2" height="44" width="19%">
        <div>
            <a id="nv-logo" href="https://www.nvidia.com/"></a>
        </div>
      <td width="81%" height="44">
        <div style="text-align:right; font-weight: bold; font-size:20px"> <br/>DriveWorks SDK Reference </div>
        <div style="text-align:right">
        5.10.87 Release <br/> For Test and Development only <br/> <br/> </div>
    </td>
  </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('dwx_lidar_plugin_sample.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Lidar Plugin Sample </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#dwx_lidar_plugin_sample_description">Description</a></li>
<li class="level1"><a href="#dwx_lidar_plugin_sample_run">The NV Lidar Plugin</a></li>
<li class="level1"><a href="#dwx_lidar_plugin_sample_walk_through">NV Lidar Plugin Walkthrough</a><ul><li class="level2"><a href="#dwx_lidar_plugin_sample_plugin_interface">Lidar Plugin Interface Definition</a></li>
<li class="level2"><a href="#dwx_lidar_plugin_sample_project_structure">Project structure</a></li>
<li class="level2"><a href="#dwx_lidar_plugin_sample_custom_lidar_class">Implementing The NV Lidar Class</a></li>
<li class="level2"><a href="#dwx_lidar_plugin_sample_function_mapping">Function Mapping</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="dwx_lidar_plugin_sample_description"></a>
Description</h1>
<p >The LIDAR Plugin sample implements a sensor driver for a UDP/TCP-based LIDAR using the comprehensive sensor plugin framework. It can be used to replay sample raw data provided with the SDK (see <a class="el" href="dwx_lidar_replay_sample.html">Lidar Replay Sample</a>), visualize and record live data.</p>
<p >It also provides sources for a refcounted-<code>BufferPool</code> data structure that may be used as reference for other implementations.</p>
<h1><a class="anchor" id="dwx_lidar_plugin_sample_run"></a>
The NV Lidar Plugin</h1>
<p >This lidar plugin compiles into a shared library (.so) that serves as a reference on how to implement a lidar plugin that is compatible with the DriveWorks Sensor Abstraction Layer (SAL). <br  />
</p>
<dl class="section note"><dt>Note</dt><dd>The precompiled decoder library is called 'libsample_nv_lidar_plugin.so'.</dd></dl>
<p><br  />
</p>
<p ><b>Live data visualization:</b> </p><pre class="fragment">./sample_lidar_replay --protocol=lidar.custom
                      --params=device=CUSTOMEX,
                               ip=XXX.XXX.XXX.XXX,
                               port=XXXXX,
                               protocol=[udp|tcp],
                               scan-frequency=[provide Hz value]
                               decoder-path=&lt;path_to_lidar_plugin.so&gt;
</pre><p> <b>Data replay:</b> ./sample_lidar_replay &ndash;protocol=lidar.virtual &ndash;params=file=&lt;path_to_lidar_recording.bin&gt;, decoder-path=&lt;path_to_lidar_plugin.so&gt;,</p>
<p ><b>Data recording(see <a class="el" href="dwx_recording_tools.html">Recording Tools</a>):</b> </p><pre class="fragment">./recorder &lt;path_to_rig_file&gt;
</pre> <dl class="section note"><dt>Note</dt><dd>A rig file that is setup to use the plugin is already provided with the SDK and is called nv_lidar_plugin_rig.json.</dd></dl>
<p>In the following sections, an overview of the implementation details and suggested project structure when developing a plugin for a custom lidar sensor will be provided. <br  />
</p>
<dl class="section note"><dt>Note</dt><dd>For more details about the plugin interface for lidars see <a class="el" href="sensorplugins_lidarsensor.html">Custom Lidars (Comprehensive)</a>. <br  />
</dd></dl>
<h1><a class="anchor" id="dwx_lidar_plugin_sample_walk_through"></a>
NV Lidar Plugin Walkthrough</h1>
<p >The NV LIDAR is a generic lidar sensor simulation that mimicks a lidar with the following specifications: </p><pre class="fragment">Supported protocols:       UDP/TCP
Scan-frequency:            30 Hz
Maximum point cloud size:  50000
</pre> <h2><a class="anchor" id="dwx_lidar_plugin_sample_plugin_interface"></a>
Lidar Plugin Interface Definition</h2>
<p >The plugin framework defines a set of function pointer definitions which must be implemented and exported to the SAL. For Lidar sensors, the plugin must have implementations for the function pointers defined in:</p>
<ul>
<li><a class="el" href="group__sensor__plugins__ext__common__group.html">Common Interface</a></li>
<li><a class="el" href="group__sensor__plugins__ext__lidar__group.html">Lidar Plugin</a></li>
</ul>
<p >In addition, the plugin must implement &amp; export the function, <code><a class="el" href="group__sensor__plugins__ext__lidar__group.html#ga039aa87c7983fe2fd65525d67e485f7c" title="Returns the table of functions that are provided by the vendor-provided library for the sensor.">dwSensorLidarPlugin_getFunctionTable()</a></code>, which is the only C function that needs to be exposed from the shared object. This allows the developer flexibility to implement internals of their plugin in C++, if necessary.</p>
<h2><a class="anchor" id="dwx_lidar_plugin_sample_project_structure"></a>
Project structure</h2>
<p >The file setup for the plugin implementation is depicted in the following image. It is not an obligatory project setup, but rather a recommendation which is easy to maintain and which this plugin implementation follows.</p>
<dl class="section note"><dt>Note</dt><dd>The provided sample implementation can be used as a template for other sensor implementations.</dd></dl>
<p><img src="lidar_plugin_file_overview.png" alt="" class="inline" title="NVLidar Plugin Project Structure"/>     <br  />
</p>
<p >The project is split into three components:</p>
<ul>
<li>Implementation of sensor class with decoding logic:<ul>
<li>NVLidar.cpp</li>
<li>NVLidar.h</li>
<li>NVLidar.hpp</li>
</ul>
</li>
<li>Plugin interface definition:<ul>
<li><a class="el" href="SensorCommonPlugin_8h.html" title="NVIDIA DriveWorks: Common Sensor Plugin Interface">SensorCommonPlugin.h</a></li>
<li><a class="el" href="LidarPlugin_8h.html" title="NVIDIA DriveWorks: Lidar Sensor Plugin Interface">LidarPlugin.h</a></li>
</ul>
</li>
<li>Mapping of sensor class funcitons to plugin function calls:<ul>
<li>main.cpp <br  />
</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="dwx_lidar_plugin_sample_custom_lidar_class"></a>
Implementing The NV Lidar Class</h2>
<p ><b>NVLidar.cpp</b> and <b>NVLidar.h</b> contain the sensor specific functionality needed to process the data being provided by the sensor along with its initialization and life cycle management.</p>
<p ><b>NVLidar_Properties.hpp </b>contains characteristics of the data stream which are utilized in the decoding logic as well as information on the layout of the data structures the received raw data is expected to map to.</p>
<p >The specific implementation details are all accessible in the respective project files for the NV Lidar plugin.</p>
<p >Specifics regarding the API function calls can be found in the <a class="el" href="sensorplugins_lidarsensor.html">Custom Lidars (Comprehensive)</a> section.</p>
<h2><a class="anchor" id="dwx_lidar_plugin_sample_function_mapping"></a>
Function Mapping</h2>
<p >Based on the interface definition the functions in the NVLidar class are mapped accordingly to their respective common sensor function call and sensor type specific funciton calls that the plugin API exposes. (see tables below) <br  />
</p>
<p ><b> Common Functions </b>(see <a class="el" href="group__sensor__plugins__ext__common__group.html">Common Interface</a>): <br  />
</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">API function   </th><th class="markdownTableHeadLeft">NVLidar member function    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code><a class="el" href="group__sensor__plugins__ext__common__group.html#ga5b47bab0b7438308dd967740f8b72aeb" title="Creates a new handle to the sensor managed by the plugin module.">dwSensorPlugin_createHandle()</a></code>   </td><td class="markdownTableBodyLeft"><code>NVLidar()</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code><a class="el" href="group__sensor__plugins__ext__common__group.html#ga5f1e233c91b4339e3d8c9a190d5ed60f" title="Releases a sensor managed by the plugin module.">dwSensorPlugin_release()</a></code>   </td><td class="markdownTableBodyLeft"><code>closeFileDescriptor()</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code><a class="el" href="group__sensor__plugins__ext__common__group.html#ga39a12415750a263a989fedce677d17da" title="Creates and initializes a new sensor managed by the plugin.">dwSensorPlugin_createSensor()</a></code>   </td><td class="markdownTableBodyLeft"><code>createSensor()</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code><a class="el" href="group__sensor__plugins__ext__common__group.html#ga797bc017eff528edd14ab9f30dc587d7" title="Starts the sensor previously successfully created with &#39;dwSensorPlugin_createSensor&#39; interface.">dwSensorPlugin_start()</a></code>   </td><td class="markdownTableBodyLeft"><code>startSensor()</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code><a class="el" href="group__sensor__plugins__ext__common__group.html#ga4b774b220a3d14f225a6764092c37dc2" title="Stops the sensor.">dwSensorPlugin_stop()</a></code>   </td><td class="markdownTableBodyLeft"><code>stopSensor()</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code><a class="el" href="group__sensor__plugins__ext__common__group.html#gadf53c6762c9df6b68f359ba8a0a21804" title="Resets the sensor.">dwSensorPlugin_reset()</a></code>   </td><td class="markdownTableBodyLeft"><code>resetSensor()</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code><a class="el" href="group__sensor__plugins__ext__common__group.html#ga411cbd695db39c75b7ece64af633d84a" title="Reads RAW data for one single message from the sensor as byte array.">dwSensorPlugin_readRawData()</a></code>   </td><td class="markdownTableBodyLeft"><code>readRawData()</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code><a class="el" href="group__sensor__plugins__ext__common__group.html#gae9b53c7222895e0b907e158662f934e6" title="Returns RAW data to sensor as a byte array.">dwSensorPlugin_returnRawData()</a></code>   </td><td class="markdownTableBodyLeft"><code>returnRawData()</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code><a class="el" href="group__sensor__plugins__ext__common__group.html#ga38fe79550a16684becc46a6c6b111156" title="Pushes raw data obtained from a previous &#39;dwSensorPlugin_readRawData&#39; call for decoding.">dwSensorPlugin_pushData()</a></code>   </td><td class="markdownTableBodyLeft"><code>pushRawData()</code>   </td></tr>
</table>
<p ><b> Lidar Specific Functions </b>(see <a class="el" href="LidarPlugin_8h.html" title="NVIDIA DriveWorks: Lidar Sensor Plugin Interface">LidarPlugin.h</a>): <br  />
</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">API function   </th><th class="markdownTableHeadLeft">NVLidar member function    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code><a class="el" href="group__sensor__plugins__ext__lidar__group.html#ga717a784732864f519923417918de4210" title="Processes the data previously passed via the &#39;dwSensorPlugin_pushData&#39; interface.">dwSensorLidarPlugin_parseDataBuffer()</a></code>   </td><td class="markdownTableBodyLeft"><code>parseDataBuffer()</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code><a class="el" href="group__sensor__plugins__ext__lidar__group.html#ga6a751eabc8dff533e9fd65f4953b6dab" title="Gets constants associated with this lidar sensor.">dwSensorLidarPlugin_getDecoderConstants()</a></code>   </td><td class="markdownTableBodyLeft"><code>getDecoderConstants()</code>   </td></tr>
</table>
<p >Naming of the sensor class functions does not have to follow the above chosen names as it is merely a suggestion.</p>
<p >Once the sensor class is implemented, one can proceed to map the functions according to the table lined out above.</p>
<p >This happens in the project file <b>main.cpp</b> which is the missing link between the API interface calls and the custom sensor class.</p>
<p >Once the respective functions are populated with their counter part in the custom lidar sensor class in the main.cpp project file, the last step is to map the those functions in the function table that is used by the SAL to access them (see <code><a class="el" href="group__sensor__plugins__ext__lidar__group.html#ga039aa87c7983fe2fd65525d67e485f7c" title="Returns the table of functions that are provided by the vendor-provided library for the sensor.">dwSensorLidarPlugin_getFunctionTable()</a></code> in main.cpp).</p>
<p >At this point the plugin implementation is complete and the project can be compiled to a shared library, ready to be used with DriveWorks. This enables processing of the custom lidar sensor data in a format that is usable within DriveWorks. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->

  <div id="nav-path" class="navpath">
    <ul>
      <li class="footer">
        Advance Information | Subject to Change |
        Prepared and Provided under NDA | Generated by NVIDIA |
        PR-08397-V5.0
      </li>
     </ul>
  </div>
</body>
</html>
