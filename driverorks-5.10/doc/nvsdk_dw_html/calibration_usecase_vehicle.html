<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!--
 * Copyright (c) 2009-2014 NVIDIA CORPORATION.  All rights reserved.
 *
 * NVIDIA Corporation and its licensors retain all intellectual property
 * and proprietary rights in and to this software, related documentation
 * and any modifications thereto.  Any use, reproduction, disclosure or
 * distribution of this software and related documentation without an express
 * license agreement from NVIDIA Corporation is strictly prohibited.
-->
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<title>DriveWorks SDK Reference: Vehicle Self-Calibration</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="Nvidia.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="reverb-search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="nv.css" rel="stylesheet" type="text/css" />
<link href="nvdwx.css" rel="stylesheet" type="text/css"/>
<style>
 body {
 background-position: 350px 150px;
 background-image: url(watermark.png);
 background-repeat: no-repeat;
 background-attachment: fixed;
 }
 </style>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table width="99%" border="0" cellspacing="1" cellpadding="1">
  <tbody>
    <tr valign="middle">
      <td rowspan="2" height="44" width="19%">
        <div>
            <a id="nv-logo" href="https://www.nvidia.com/"></a>
        </div>
      <td width="81%" height="44">
        <div style="text-align:right; font-weight: bold; font-size:20px"> <br/>DriveWorks SDK Reference </div>
        <div style="text-align:right">
        5.10.87 Release <br/> For Test and Development only <br/> <br/> </div>
    </td>
  </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('calibration_usecase_vehicle.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Vehicle Self-Calibration </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Operating Principle</h1>
<p >NVIDIA<sup>&reg;</sup> DriveWorks uses vehicle model to calibrate the steering system properities using vehicle odometery and vehicle egomotion measurement and predicted vehicle motion based on vehicle model.</p>
<h2>Steering Offset</h2>
<p >Vehicle self-calibration supports vehicle steering offset self calibration. The steering offset is the difference between the actual steering and the measured steering angle, and it equals to the negative of the measured steering angle when the vehicle drive straight. The steering offset is calibrated by minimizing the predicted turn curvature based on model and curvature computed based on measurement data. To start the calibration process, the vehicle has to drive above 10 meter per seocnd, perform gradual lane change maneuvers.</p>
<div class="image">
<img src="self_calib_vehicle.png" alt=""/>
<div class="caption">
Normalized steering offset q3 (steering offset / wheelbase) (center histogram), and Understeer coefficient (left histogram)collected over a period of time</div></div>
    <h1>Requirements</h1>
<h2>Initialization Requirements</h2>
<ul>
<li>Nominal values on vehicle calibration<ul>
<li>steering offset: 0 radian</li>
</ul>
</li>
</ul>
<h2>Runtime Calibration Dependencies</h2>
<ul>
<li>IMU-based egomotion needs to be based on accurate IMU calibration and odometry properties</li>
</ul>
<h2>Input Requirements</h2>
<ul>
<li>Assumption: Vehicle performs the aforementioned maneuvers until calibration convergence.</li>
<li>Vehicle egomotion: requirements can be found in the <a class="el" href="egomotion_mainsection.html">Egomotion</a> module</li>
<li>Vehicle IO State: requirements can be found in the <a class="el" href="vehicleio_mainsection.html">VehicleIO</a> VehicleIO</li>
</ul>
<h2>Output Requirements</h2>
<ul>
<li>Corrected steering offset: less than 0.8 degrees accuracy</li>
</ul>
<h1>Cross-validation KPI</h1>
<p >Several hours of data are used to produce a reference calibration value for cross-validation. Then, short periods of data are evaluated for whether they can recover the same values. For example, the graph below shows precision/recall curves of normalized steering offset q3 (q3=steering offset / wheelbase). Precision indicates that an accepted calibration is within a fixed precision threshold from the reference calibration, and recall indicates the ratio of accepted calibrations in the given amount of time.</p>
<div class="image">
<img src="self_calib_vehicle_kpi.png" alt=""/>
</div>
    <h1>Workflow</h1>
<p >The following code snippet shows the general structure of a program that performs IMU self-calibration</p>
<div class="fragment"><div class="line"><a class="code hl_function" href="group__calibration__group.html#ga92ee0458420c6d398d3871303de98973">dwCalibrationEngine_initialize</a>(...);           <span class="comment">// depends on sensor from rig configuration module</span></div>
<div class="line"><a class="code hl_function" href="group__calibration__group.html#gae056d084773dd9631b9ad33520b221d5">dwCalibrationEngine_initializeVehicle</a>(...);    <span class="comment">// depends on nominal calibration from rig configuration</span></div>
<div class="line"><a class="code hl_function" href="group__calibration__group.html#ga9a509def08788c1876c8af2000af83ce">dwCalibrationEngine_startCalibration</a>(...);     <span class="comment">// runtime calibration dependencies need to be met</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">while</span>(<span class="keyword">true</span>) <span class="comment">// main loop</span></div>
<div class="line">{</div>
<div class="line">    <span class="comment">// get current vehicle IO state</span></div>
<div class="line">    <a class="code hl_function" href="group__VehicleIO__actuators__group.html#ga64226a58a43467a8c469b4e2fa2e33d9">dwVehicleIO_getVehicleNonSafetyState</a>(&amp;vehicleIONonSafetyState, ...);</div>
<div class="line">    <a class="code hl_function" href="group__VehicleIO__actuators__group.html#ga1de5cf6fa7553c80387d7febeb3c2e42">dwVehicleIO_getVehicleActuationFeedback</a>(&amp;vehicleIOActuationFeedback, ...);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// feed vehicle io state into self-calibration</span></div>
<div class="line">    <a class="code hl_function" href="group__calibration__group.html#ga932ecb4e927cb035f2c93a31fc61a10a">dwCalibrationEngine_addVehicleIONonSafetyState</a>(&amp;vehicleIONonSafetyState, ...);</div>
<div class="line">    <a class="code hl_function" href="group__calibration__group.html#ga4fbe9193988cf194094749bd7bcd178e">dwCalibrationEngine_addVehicleIOActuationFeedback</a>(&amp;vehicleIOActuationFeedback, ...);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// retrieve calibration status</span></div>
<div class="line">    <a class="code hl_function" href="group__calibration__group.html#ga3ec3a048d476315d0debab207f5da156">dwCalibrationEngine_getCalibrationStatus</a>(...);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// retrieve self-calibration results</span></div>
<div class="line">    <a class="code hl_function" href="group__calibration__group.html#gafe1f0bd25204a9f4204e6e10a8ce8b4f">dwCalibrationEngine_getVehicleSteeringProperties</a>(...);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="group__calibration__group.html#gae4948b8898f6085b079670e049982e93">dwCalibrationEngine_stopCalibration</a>(...);</div>
<div class="ttc" id="agroup__VehicleIO__actuators__group_html_ga1de5cf6fa7553c80387d7febeb3c2e42"><div class="ttname"><a href="group__VehicleIO__actuators__group.html#ga1de5cf6fa7553c80387d7febeb3c2e42">dwVehicleIO_getVehicleActuationFeedback</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwVehicleIO_getVehicleActuationFeedback(dwVehicleIOActuationFeedback *const actuationFeedback, dwVehicleIOHandle_t const obj)</div><div class="ttdoc">Retrieve current vehicle actuation feedback.</div></div>
<div class="ttc" id="agroup__VehicleIO__actuators__group_html_ga64226a58a43467a8c469b4e2fa2e33d9"><div class="ttname"><a href="group__VehicleIO__actuators__group.html#ga64226a58a43467a8c469b4e2fa2e33d9">dwVehicleIO_getVehicleNonSafetyState</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwVehicleIO_getVehicleNonSafetyState(dwVehicleIONonSafetyState *const nonSafeState, dwVehicleIOHandle_t const obj)</div><div class="ttdoc">Retrieve current vehicle non-safety state.</div></div>
<div class="ttc" id="agroup__calibration__group_html_ga3ec3a048d476315d0debab207f5da156"><div class="ttname"><a href="group__calibration__group.html#ga3ec3a048d476315d0debab207f5da156">dwCalibrationEngine_getCalibrationStatus</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwCalibrationEngine_getCalibrationStatus(dwCalibrationStatus *status, dwCalibrationRoutineHandle_t routine, dwCalibrationEngineHandle_t engine)</div><div class="ttdoc">Returns the current status of a calibration routine.</div></div>
<div class="ttc" id="agroup__calibration__group_html_ga4fbe9193988cf194094749bd7bcd178e"><div class="ttname"><a href="group__calibration__group.html#ga4fbe9193988cf194094749bd7bcd178e">dwCalibrationEngine_addVehicleIOActuationFeedback</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwCalibrationEngine_addVehicleIOActuationFeedback(dwVehicleIOActuationFeedback const *vioActuationFeedback, uint32_t sensorIndex, dwCalibrationEngineHandle_t engine)</div><div class="ttdoc">Adds dwVehicleIOActuationFeedback to calibration engine.</div></div>
<div class="ttc" id="agroup__calibration__group_html_ga92ee0458420c6d398d3871303de98973"><div class="ttname"><a href="group__calibration__group.html#ga92ee0458420c6d398d3871303de98973">dwCalibrationEngine_initialize</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwCalibrationEngine_initialize(dwCalibrationEngineHandle_t *engine, dwRigHandle_t rig, dwContextHandle_t context)</div><div class="ttdoc">Creates and initializes a Calibration Engine.</div></div>
<div class="ttc" id="agroup__calibration__group_html_ga932ecb4e927cb035f2c93a31fc61a10a"><div class="ttname"><a href="group__calibration__group.html#ga932ecb4e927cb035f2c93a31fc61a10a">dwCalibrationEngine_addVehicleIONonSafetyState</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwCalibrationEngine_addVehicleIONonSafetyState(dwVehicleIONonSafetyState const *vioNonSafetyState, uint32_t sensorIndex, dwCalibrationEngineHandle_t engine)</div><div class="ttdoc">Adds dwVehicleIONonSafetyState to calibration engine.</div></div>
<div class="ttc" id="agroup__calibration__group_html_ga9a509def08788c1876c8af2000af83ce"><div class="ttname"><a href="group__calibration__group.html#ga9a509def08788c1876c8af2000af83ce">dwCalibrationEngine_startCalibration</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwCalibrationEngine_startCalibration(dwCalibrationRoutineHandle_t routine, dwCalibrationEngineHandle_t engine)</div><div class="ttdoc">Starts a calibration routine associated with a calibration engine.</div></div>
<div class="ttc" id="agroup__calibration__group_html_gae056d084773dd9631b9ad33520b221d5"><div class="ttname"><a href="group__calibration__group.html#gae056d084773dd9631b9ad33520b221d5">dwCalibrationEngine_initializeVehicle</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwCalibrationEngine_initializeVehicle(dwCalibrationRoutineHandle_t *routine, uint32_t sensorIndex, const dwCalibrationVehicleParams *params, dwEgomotionConstHandle_t egoMotion, const dwVehicle *vehicle, dwCalibrationEngineHandle_t engine)</div><div class="ttdoc">Initialize vehicle parameter calibration.</div></div>
<div class="ttc" id="agroup__calibration__group_html_gae4948b8898f6085b079670e049982e93"><div class="ttname"><a href="group__calibration__group.html#gae4948b8898f6085b079670e049982e93">dwCalibrationEngine_stopCalibration</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwCalibrationEngine_stopCalibration(dwCalibrationRoutineHandle_t routine, dwCalibrationEngineHandle_t engine)</div><div class="ttdoc">Stops a calibration routine associated with a calibration engine.</div></div>
<div class="ttc" id="agroup__calibration__group_html_gafe1f0bd25204a9f4204e6e10a8ce8b4f"><div class="ttname"><a href="group__calibration__group.html#gafe1f0bd25204a9f4204e6e10a8ce8b4f">dwCalibrationEngine_getVehicleSteeringProperties</a></div><div class="ttdeci">DW_API_PUBLIC dwStatus dwCalibrationEngine_getVehicleSteeringProperties(dwVehicleSteeringProperties *steering, dwCalibrationRoutineHandle_t routine, dwCalibrationEngineHandle_t engine)</div><div class="ttdoc">Get vehicle parameter calibration result.</div></div>
</div><!-- fragment --><p >This workflow is demonstrated in the following sample: <a class="el" href="dwx_vehicle_steering_calibration_sample.html">Steering Calibration Sample</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->

  <div id="nav-path" class="navpath">
    <ul>
      <li class="footer">
        Advance Information | Subject to Change |
        Prepared and Provided under NDA | Generated by NVIDIA |
        PR-08397-V5.0
      </li>
     </ul>
  </div>
</body>
</html>
