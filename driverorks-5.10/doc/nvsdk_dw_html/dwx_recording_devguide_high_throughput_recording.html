<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!--
 * Copyright (c) 2009-2014 NVIDIA CORPORATION.  All rights reserved.
 *
 * NVIDIA Corporation and its licensors retain all intellectual property
 * and proprietary rights in and to this software, related documentation
 * and any modifications thereto.  Any use, reproduction, disclosure or
 * distribution of this software and related documentation without an express
 * license agreement from NVIDIA Corporation is strictly prohibited.
-->
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<title>DriveWorks SDK Reference: High Throughput Recording</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="Nvidia.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="reverb-search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="nv.css" rel="stylesheet" type="text/css" />
<link href="nvdwx.css" rel="stylesheet" type="text/css"/>
<style>
 body {
 background-position: 350px 150px;
 background-image: url(watermark.png);
 background-repeat: no-repeat;
 background-attachment: fixed;
 }
 </style>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table width="99%" border="0" cellspacing="1" cellpadding="1">
  <tbody>
    <tr valign="middle">
      <td rowspan="2" height="44" width="19%">
        <div>
            <a id="nv-logo" href="https://www.nvidia.com/"></a>
        </div>
      <td width="81%" height="44">
        <div style="text-align:right; font-weight: bold; font-size:20px"> <br/>DriveWorks SDK Reference </div>
        <div style="text-align:right">
        5.10.87 Release <br/> For Test and Development only <br/> <br/> </div>
    </td>
  </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('dwx_recording_devguide_high_throughput_recording.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">High Throughput Recording </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#dwx_recording_devguide_high_determining_speed">Determining the Required the USB Disk Speed</a></li>
<li class="level1"><a href="#dwx_recording_devguide_high_options">Options for Capturing High-Throughput Data</a></li>
<li class="level1"><a href="#dwx_recording_devguide_high_achieving_max_throughput">Achieving the Maximum USB Throughput</a></li>
</ul>
</div>
<div class="textblock"><p >This section provides guidance on developing strategies for recording the huge amounts of data that multiple cameras can produce.</p>
<h1><a class="anchor" id="dwx_recording_devguide_high_determining_speed"></a>
Determining the Required the USB Disk Speed</h1>
<p >Because of storage limitations with the platform's local file system, sensor data is stored on an external USB 3.0 drive. But the drive must be fast enough to keep up with the amount of data that your sensors generate. For example, four cameras generating RAW data at 30 frames per second can exceed the bandwidth of most SSD USB drives.</p>
<p >The required write speed of the drives depends on the number of sensors and the recording format. If you are recording RAW data, calculate the required drive speed as: </p><pre class="fragment">width * height * 2 * fps = bytes/second
</pre><p> RAW recording consumes most of the bandwidth.</p>
<h1><a class="anchor" id="dwx_recording_devguide_high_options"></a>
Options for Capturing High-Throughput Data</h1>
<p >The following table provides suggestions for recording more than three cameras generating RAW.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Cameras generating RAW   </th><th class="markdownTableHeadNone">Framerate   </th><th class="markdownTableHeadNone">Options    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">3-4   </td><td class="markdownTableBodyNone">30   </td><td class="markdownTableBodyNone">Attach all cameras to a single Xavier and mount a USB on that Xavier.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">6-8   </td><td class="markdownTableBodyNone">30   </td><td class="markdownTableBodyNone"><ul>
<li>
Attach 3-4 cameras to Xavier A and mount a USB on that Xavier.</li>
<li>
Do the same for Xavier B.</li>
<li>
Use PTP or gPTP to synchronize camera timestamps between the Xavier cameras.</li>
</ul>
</td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">12   </td><td class="markdownTableBodyNone">30   </td><td class="markdownTableBodyNone">Use two NVIDIA DRIVE platforms. For each platform, follow the steps as for 6-8 cameras at 30 FPS.   </td></tr>
</table>
<h1><a class="anchor" id="dwx_recording_devguide_high_achieving_max_throughput"></a>
Achieving the Maximum USB Throughput</h1>
<p >If you need to store more data than your USB device can handle, consider distributing recording across the different Xavier processors. For more information, see <a class="el" href="dwx_devguide_rec_distrec.html">Distributed Recording</a> in this guide.</p>
<p >The system automatically mounts the USB drive.</p>
<h2>To initialize your USB disk (Linux)</h2>
<ol type="1">
<li>Enable the CFQ schedule for the USB disk: <pre class="fragment"># echo cfq &gt; /sys/block/sda/queue/scheduler
</pre> The directory /sys/block/device/queue/iosched contains files that allow the administrator to retrieve and set tunable values related to the I/O scheduler.</li>
<li>Change the memory limit for the I/O scheduler. <pre class="fragment"># echo 1000 &gt; /sys/module/usbcore/parameters/usbfs_memory_mb
</pre></li>
<li>Confirm you successfully updated the memory limit. <pre class="fragment"># cat /sys/module/usbcore/parameters/usbfs_memory_mb
</pre> <h2>To optimize your platform to store recorded data (Linux)</h2>
</li>
</ol>
<ol type="1">
<li>Locate and edit the following file: <pre class="fragment">/etc/sysctl.conf
</pre></li>
<li>Modify the file to have the following settings. These are persistent changes and are preserved between reboots. <div class="fragment"><div class="line">net.core.rmem_default = 1048576</div>
<div class="line">net.core.rmem_max = 10485760</div>
<div class="line">net.core.wmem_default = 1048576</div>
<div class="line">net.core.wmem_max = 10485760</div>
<div class="line">net.core.netdev_max_backlog = 30000</div>
<div class="line">net.ipv4.ipfrag_high_thresh = 8388608</div>
<div class="line">net.ipv6.conf.all.disable_ipv6 = 1</div>
<div class="line">vm.dirty_background_ratio = 5</div>
<div class="line">vm.dirty_ratio = 50</div>
</div><!-- fragment --></li>
</ol>
<h2>To determine the write speed of the mounted jbod disk (Linux)</h2>
<ul>
<li>Enter: <pre class="fragment"> # dd if=/dev/zero of=/media/NVidia/folder#/file bs=1G count=10
</pre> The JBod disk is mounted on: <pre class="fragment"> /media/NVidia/
</pre> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->

  <div id="nav-path" class="navpath">
    <ul>
      <li class="footer">
        Advance Information | Subject to Change |
        Prepared and Provided under NDA | Generated by NVIDIA |
        PR-08397-V5.0
      </li>
     </ul>
  </div>
</body>
</html>
